// SFA, 2x2サイト

#include <iostream.h>
#include <fstream.h>
#include <math.h>
//#include <process.h>
#include "dsyev.h"

main()
{
	int i,j,n,m,N,n_omega,x,xx,y,yy,kx,kkx,ky,kky; int n_tt;
	double Kx,KKx,Ky,KKy; const double pi=3.1415926535897932;
	double cd_31[2][2][24][36],cu_32[2][2][24][36],cu_21[2][2][36][24],cd_21[2][2][36][24]; // 21 -> 42
	double e,t,tn,U,mu,h; double ee,tt,ttn,F,AF,Px,Py; double alpha; double tta;
	double H31[24][24],H32[24][24],H42[36][36],H52[24][24],H53[24][24];
	double E31[24],E32[24],E42[36],E52[24],E53[24];
	double work[107]; char jobz='V'; char uplo='U'; int info;
	
	double GRI0u[4][4],GRI0d[4][4];
	double Au[4][4][56],Ad[4][4][56],Bu[4][4][56],Bd[4][4][56],au[2][2],ad[2][2],bu[2][2],bd[2][2];
	double GRu[4][4],GRd[4][4],gRu[4],gRd[4],SEu[4][4],SEd[4][4],GIu[4][4],GId[4][4],gIu[4],gId[4],band;
	double omega,Omega_r[41],Omega_t[41],Omega,Sur[41],Sdr[41],Sug[41],Sdg[41],Sr[41],Sg[41]; int Nur,Ndr,Nug,Ndg;
	double AAu[4][4],BBu[4][4],AAd[4][4],BBd[4][4],Iu[4][4],Id[4][4];
	// 生成消滅演算子
	for(x=0;x<=1;++x){
		for(y=0;y<=1;++y){
			for(i=0;i<=35;++i){
				for(j=0;j<=23;++j){
					cu_21[x][y][i][j]=cd_21[x][y][i][j]=cd_31[x][y][j][i]=cu_32[x][y][j][i]=0.0;
				};
			};
		};
	};
	// d [3,1](0,.,4,.,8,.,12,.,16,.,20,...,23) [4,2](0,.,6,.,12,.,18,.,24,.,30,...,35)
	cd_31[0][0][1][0]=cd_31[0][0][2][1]=cd_31[0][0][3][2]=-1.0;
	cd_31[0][0][5][6]=cd_31[0][0][6][7]=cd_31[0][0][11][8]=-1.0;
	cd_31[0][0][9][12]=cd_31[0][0][10][13]=cd_31[0][0][15][14]=-1.0;
	cd_31[0][0][13][18]=cd_31[0][0][14][19]=cd_31[0][0][19][20]=1.0;
	cd_31[0][0][17][24]=cd_31[0][0][18][25]=cd_31[0][0][23][26]=1.0;
	cd_31[0][0][21][30]=cd_31[0][0][22][31]=cd_31[0][0][27][32]=1.0;
	
	cd_31[1][0][0][0]=-1.0;   cd_31[1][0][2][3]=cd_31[1][0][3][4]=1.0;
	cd_31[1][0][4][6]=1.0;    cd_31[1][0][6][9]=cd_31[1][0][7][10]=-1.0;
	cd_31[1][0][8][12]=1.0;   cd_31[1][0][10][17]=cd_31[1][0][11][16]=-1.0;
	cd_31[1][0][12][18]=1.0;  cd_31[1][0][14][23]=cd_31[1][0][15][22]=-1.0;
	cd_31[1][0][16][24]=1.0;  cd_31[1][0][18][30]=cd_31[1][0][19][28]=-1.0;
	cd_31[1][0][20][30]=-1.0; cd_31[1][0][22][37]=cd_31[1][0][23][34]=1.0;
	
	cd_31[0][1][0][1]=cd_31[0][1][1][3]=-1.0;     cd_31[0][1][3][5]=1.0;
	cd_31[0][1][4][7]=cd_31[0][1][5][9]=-1.0;     cd_31[0][1][7][11]=1.0;
	cd_31[0][1][8][13]=cd_31[0][1][9][15]=1.0;    cd_31[0][1][11][17]=-1.0;
	cd_31[0][1][12][19]=cd_31[0][1][13][21]=-1.0; cd_31[0][1][15][23]=1.0;
	cd_31[0][1][16][25]=cd_31[0][1][17][27]=1.0;  cd_31[0][1][19][29]=-1.0;
	cd_31[0][1][20][31]=cd_31[0][1][21][33]=1.0;  cd_31[0][1][23][35]=-1.0;
	
	cd_31[1][1][0][2]=cd_31[1][1][1][4]=cd_31[1][1][2][5]=-1.0;
	cd_31[1][1][4][6]=cd_31[1][1][5][8]=cd_31[1][1][6][9]=-1.0;
	cd_31[1][1][8][10]=cd_31[1][1][9][12]=cd_31[1][1][10][13]=-1.0;
	cd_31[1][1][12][14]=cd_31[1][1][13][16]=cd_31[1][1][14][17]=-1.0;
	cd_31[1][1][16][18]=cd_31[1][1][17][20]=cd_31[1][1][18][21]=-1.0;
	cd_31[1][1][20][22]=cd_31[1][1][21][24]=cd_31[1][1][22][25]=-1.0;
	// u_32 [3,2](0,.,4,.,8,.,12,.,16,.,20,...,24) [4,2](0,.,6,.,12,.,18,.,24,.,30,...,35)
	cu_32[0][0][1][0]=cu_32[0][0][2][6]=cu_32[0][0][4][12] =1.0;
	cu_32[0][0][5][1]=cu_32[0][0][6][7]=cu_32[0][0][8][13]=1.0;
	cu_32[0][0][9][2]=cu_32[0][0][10][8]=cu_32[0][0][12][14]=1.0;
	cu_32[0][0][13][3]=cu_32[0][0][14][9]=cu_32[0][0][16][15]=1.0;
	cu_32[0][0][17][4]=cu_32[0][0][18][10]=cu_32[0][0][20][16]=1.0;
	cu_32[0][0][21][5]=cu_32[0][0][22][11]=cu_32[0][0][24][17]=1.0;
	
	cu_32[1][0][0][0]=1.0;   cu_32[1][0][2][18]=cu_32[1][0][3][24]=-1.0;
	cu_32[1][0][4][1]=1.0;   cu_32[1][0][6][19]=cu_32[1][0][7][25]=-1.0;
	cu_32[1][0][8][2]=1.0;   cu_32[1][0][10][20]=cu_32[1][0][11][26]=-1.0;
	cu_32[1][0][12][3]=-1.0; cu_32[1][0][14][21]=cu_32[1][0][15][27]=1.0;
	cu_32[1][0][16][4]=-1.0; cu_32[1][0][18][22]=cu_32[1][0][19][28]=1.0;
	cu_32[1][0][20][5]=-1.0; cu_32[1][0][22][23]=cu_32[1][0][23][29]=1.0;
	
	cu_32[0][1][0][6]=cu_32[0][1][1][18] =-1.0;   cu_32[0][1][3][30] =1.0;
	cu_32[0][1][4][7]=cu_32[0][1][5][19] =1.0;    cu_32[0][1][7][31]=-1.0;
	cu_32[0][1][8][8]=cu_32[0][1][9][20]=1.0;     cu_32[0][1][11][32]=-1.0;
	cu_32[0][1][12][9]=cu_32[0][1][13][21]=1.0;   cu_32[0][1][15][33]=-1.0;
	cu_32[0][1][16][10]=cu_32[0][1][17][22]=1.0;  cu_32[0][1][19][34]=-1.0;
	cu_32[0][1][20][11]=cu_32[0][1][21][23]=-1.0; cu_32[0][1][23][35]=1.0;
	
	cu_32[1][1][0][12]=cu_32[1][1][1][24]=cu_32[1][1][2][30] =-1.0;
	cu_32[1][1][4][13]=cu_32[1][1][5][25]=cu_32[1][1][6][31]=-1.0;
	cu_32[1][1][8][14]=cu_32[1][1][9][26]=cu_32[1][1][10][32]=1.0;
	cu_32[1][1][12][15]=cu_32[1][1][13][27]=cu_32[1][1][14][33]=-1.0;
	cu_32[1][1][16][16]=cu_32[1][1][17][28]=cu_32[1][1][18][34]=1.0;
	cu_32[1][1][20][17]=cu_32[1][1][21][29]=cu_32[1][1][22][35]=1.0;
	// u_21 [4,2](0,.,6,.,12,.,18,.,24,.,30,...,35) [5,2](0,.,6,.,12,.,18,...,23)
	cu_21[0][0][18][0]=cu_21[0][0][24][6]=cu_21[0][0][30][12]=1.0;
	cu_21[0][0][19][1]=cu_21[0][0][25][7]=cu_21[0][0][31][13]=1.0;
	cu_21[0][0][20][2]=cu_21[0][0][26][8]=cu_21[0][0][32][14]=1.0;
	cu_21[0][0][21][3]=cu_21[0][0][27][9]=cu_21[0][0][33][15]=1.0;
	cu_21[0][0][22][4]=cu_21[0][0][28][10]=cu_21[0][0][34][16]=1.0;
	cu_21[0][0][23][5]=cu_21[0][0][29][11]=cu_21[0][0][35][17]=1.0;
	
	cu_21[1][0][6][0]=cu_21[1][0][12][6]=1.0;    cu_21[1][0][30][18]=-1.0;
	cu_21[1][0][7][1]=cu_21[1][0][13][7]=1.0;    cu_21[1][0][31][19]=-1.0;
	cu_21[1][0][8][2]=cu_21[1][0][14][8]=1.0;    cu_21[1][0][32][20]=-1.0;
	cu_21[1][0][9][3]=cu_21[1][0][15][9]=-1.0;   cu_21[1][0][33][21]=1.0;
	cu_21[1][0][10][4]=cu_21[1][0][16][10]=-1.0; cu_21[1][0][34][22]=1.0;
	cu_21[1][0][11][5]=cu_21[1][0][17][11]=-1.0; cu_21[1][0][35][23]=1.0;
	
	cu_21[0][1][0][0]=1.0; cu_21[0][1][12][12]=cu_21[0][1][24][18]=-1.0;
	cu_21[0][1][1][1]=-1.0; cu_21[0][1][13][13]=cu_21[0][1][25][19]=1.0;
	cu_21[0][1][2][2]=-1.0; cu_21[0][1][14][14]=cu_21[0][1][26][20]=1.0;
	cu_21[0][1][3][3]=-1.0; cu_21[0][1][15][15]=cu_21[0][1][27][21]=1.0;
	cu_21[0][1][4][4]=-1.0; cu_21[0][1][16][16]=cu_21[0][1][28][22]=1.0;
	cu_21[0][1][5][5]=1.0; cu_21[0][1][17][17]=cu_21[0][1][29][23]=-1.0;
	
	cu_21[1][1][0][6]=cu_21[1][1][6][12]=cu_21[1][1][12][18]=1.0;
	cu_21[1][1][1][7]=cu_21[1][1][7][13]=cu_21[1][1][13][19]=1.0;
	cu_21[1][1][2][8]=cu_21[1][1][8][14]=cu_21[1][1][14][20]=-1.0;
	cu_21[1][1][3][9]=cu_21[1][1][9][15]=cu_21[1][1][15][21]=1.0;
	cu_21[1][1][4][10]=cu_21[1][1][10][16]=cu_21[1][1][16][22]=-1.0;
	cu_21[1][1][5][11]=cu_21[1][1][11][17]=cu_21[1][1][17][23]=-1.0;
	// d_21 [4,2](0,.,6,.,12,.,18,.,24,.,30,...,35) [5,3](0,.,6,.,12,.,18,...,23)
	cd_21[0][0][3][0]=cd_21[0][0][4][6]=cd_21[0][0][5][12]=-1.0;
	cd_21[0][0][9][1]=cd_21[0][0][10][7]=cd_21[0][0][11][13]=-1.0;
	cd_21[0][0][15][2]=cd_21[0][0][16][8]=cd_21[0][0][17][14]=-1.0;
	cd_21[0][0][21][3]=cd_21[0][0][22][9]=cd_21[0][0][23][15]=1.0;
	cd_21[0][0][27][4]=cd_21[0][0][28][10]=cd_21[0][0][29][16]=1.0;
	cd_21[0][0][33][5]=cd_21[0][0][34][11]=cd_21[0][0][35][17]=1.0;
	
	cd_21[1][0][1][0]=cd_21[1][0][2][6]=-1.0;    cd_21[1][0][5][18]=1.0;
	cd_21[1][0][7][1]=cd_21[1][0][8][7]=1.0;     cd_21[1][0][11][19]=-1.0;
	cd_21[1][0][13][2]=cd_21[1][0][14][8]=1.0;   cd_21[1][0][17][20]=-1.0;
	cd_21[1][0][19][3]=cd_21[1][0][20][9]=1.0;   cd_21[1][0][23][21]=-1.0;
	cd_21[1][0][25][4]=cd_21[1][0][26][10]=1.0;  cd_21[1][0][29][22]=-1.0;
	cd_21[1][0][31][5]=cd_21[1][0][32][11]=-1.0; cd_21[1][0][35][23]=1.0;
	
	cd_21[0][1][0][0]=1.0;    cd_21[0][1][2][12]=cd_21[0][1][4][18]=-1.0;
	cd_21[0][1][6][1]=1.0;    cd_21[0][1][8][13]=cd_21[0][1][10][19]=-1.0;
	cd_21[0][1][12][2]=-1.0;  cd_21[0][1][14][14]=cd_21[0][1][16][20]=1.0;
	cd_21[0][1][18][3]=1.0;   cd_21[0][1][20][15]=cd_21[0][1][22][21]=-1.0;
	cd_21[0][1][24][4]=-1.0;  cd_21[0][1][26][16]=cd_21[0][1][28][22]=1.0;
	cd_21[0][1][30][5]=-1.0;  cd_21[0][1][32][17]=cd_21[0][1][34][23]=1.0;
	
	cd_21[1][1][0][6]=cd_21[1][1][1][12]=cd_21[1][1][2][18]=1.0;
	cd_21[1][1][6][7]=cd_21[1][1][7][13]=cd_21[1][1][8][19]=1.0;
	cd_21[1][1][12][8]=cd_21[1][1][13][14]=cd_21[1][1][14][20]=1.0;
	cd_21[1][1][18][9]=cd_21[1][1][19][15]=cd_21[1][1][20][21]=1.0;
	cd_21[1][1][24][10]=cd_21[1][1][25][16]=cd_21[1][1][26][22]=1.0;
	cd_21[1][1][30][11]=cd_21[1][1][31][17]=cd_21[1][1][32][23]=1.0;
	
	// 元の系のパラメーター double e,t,tn,U,mu,h; double ee,tt,ttn,F,AF,Px,Py;
	e=0.0; t=1.0; h=0.0;
	cout << "tn="; cin >> tn;
	cout << "U="; cin >> U;
	cout << "mu="; cin >> mu;  //mu=U/2.0;
	// 代理系のパラメーター
	ee=0.0; ttn=tn; F=0.0; Px=0.0; Py=0.0;
	cout << "AF="; cin >> AF;
	
	// 元の系のグリーン関数の初期化
	for(i=0;i<=3;++i){
		for(j=0;j<=3;++j){
			GIu[i][j]=GId[i][j]=0.0;
		};
	};
	// 代理系のハミルトニアンの初期化
	for(i=0;i<=35;++i){
		for(j=0;j<=35;++j){
			H42[i][j]=0.0;
		};
	};
	for(i=0;i<=23;++i){
		for(j=0;j<=23;++j){
			H31[i][j]=H32[i][j]=H52[i][j]=H53[i][j]=0.0;
		};
	};
	// 熱力学ポテンシャルなどの初期化
	Omega_r[n_tt]=Omega_t[n_tt]=Sr[n_tt]=Sg[n_tt]=0.0;
	Sur[n_tt]=Sdr[n_tt]=Sug[n_tt]=Sdg[n_tt]=0.0; Nur=Ndr=Nug=Ndg=0;
	// 代理系のハミルトニアンの対角成分
	// H42 (0,.,6,.,12,.,18,.,24,.,30,...,35)
	H42[0][0]=H42[7][7]=H42[14][14]=H42[21][21]=H42[28][28]=H42[35][35]=(4*ee-4*mu)+2*U;
	H42[1][1]=H42[4][4]=H42[6][6]=H42[11][11]=H42[24][24]=H42[29][29]=H42[31][31]=H42[34][34]=(4*ee-4*mu)+U;
	H42[2][2]=H42[8][8]=H42[18][18]=H42[19][19]=H42[22][22]=H42[23][23]=H42[26][26]=H42[32][32]=(4*ee-4*mu)+U+2*AF;
	H42[3][3]=H42[9][9]=H42[12][12]=H42[13][13]=H42[16][16]=H42[17][17]=H42[27][27]=H42[33][33]=(4*ee-4*mu)+U-2*AF;
	H42[5][5]=H42[10][10]=H42[15][15]=H42[20][20]=H42[25][25]=H42[30][30]=4*ee-4*mu;
	// H31 (0,.,4,.,8,.,12,.,16,.,20,...,23) (4,.,8,.,12,.,16,.,20,.,24,...,27)
	H31[0][0]=H31[4][4]=H31[13][13]=H31[14][14]=H31[19][19]=H31[23][23]=(3*ee-F-3*mu)+U+AF;
	H31[1][1]=H31[6][6]=H31[8][8]=H31[11][11]=H31[17][17]=H31[22][22]=(3*ee-F-3*mu)+U-AF;
	H31[2][2]=H31[5][5]=H31[18][18]=H31[21][21]=(3*ee-F-3*mu)-AF;
	H31[3][3]=H31[7][7]=H31[16][16]=H31[20][20]=(3*ee-F-3*mu)+AF;
	H31[9][9]=H31[10][10]=(3*ee-F-3*mu)-3*AF;
	H31[12][12]=H31[15][15]=(3*ee-F-3*mu)+3*AF;
	// H52 (0,.,6,.,12,.,18,.,23) (28,.,34,.,40,.,46,.,51)
	H52[0][0]=H52[1][1]=H52[8][8]=H52[14][14]=H52[22][22]=H52[23][23]=(5*ee-F-5*mu)+2*U+AF;
	H52[2][2]=H52[20][20]=(5*ee-F-5*mu)+U+3*AF;
	H52[3][3]=H52[6][6]=H52[10][10]=H52[13][13]=H52[17][17]=H52[21][21]=(5*ee-F-5*mu)+2*U-AF;
	H52[4][4]=H52[5][5]=H52[18][18]=H52[19][19]=(5*ee-F-5*mu)+U+AF;
	H52[7][7]=H52[11][11]=H52[12][12]=H52[16][16]=(5*ee-F-5*mu)+U-AF;
	H52[9][9]=H52[15][15]=(5*ee-F-5*mu)+U-3*AF;
	// H32 (0,.,4,.,8,.,12,.,16,.,20,...,23)
	H32[0][0]=H32[4][4]=H32[13][13]=H32[14][14]=H32[19][19]=H32[23][23]=(3*ee+F-3*mu)+U-AF;
	H32[1][1]=H32[6][6]=H32[8][8]=H32[11][11]=H32[17][17]=H32[22][22]=(3*ee+F-3*mu)+U+AF;
	H32[2][2]=H32[3][3]=H32[18][18]=H32[21][21]=(3*ee+F-3*mu)+AF;
	H32[3][3]=H32[7][7]=H32[16][16]=H32[20][20]=(3*ee+F-3*mu)-AF;
	H32[9][9]=H32[10][10]=(3*ee+F-3*mu)+3*AF;
	H32[12][12]=H32[15][15]=(3*ee+F-3*mu)-3*AF;
	// H53 (0,.,6,.,12,.,18,...,23)
	H53[0][0]=H53[1][1]=H53[8][8]=H53[14][14]=H53[22][22]=H53[23][23]=(5*ee+F-5*mu)+2*U-AF;
	H53[2][2]=H53[20][20]=(5*ee+F-5*mu)+U-3*AF;
	H53[3][3]=H53[6][6]=H53[10][10]=H53[13][13]=H53[17][17]=H53[21][21]=(5*ee+F-5*mu)+2*U+AF;
	H53[4][4]=H53[5][5]=H53[18][18]=H53[19][19]=(5*ee+F-5*mu)+U-AF;
	H53[7][7]=H53[11][11]=H53[12][12]=H53[16][16]=(5*ee+F-5*mu)+U+AF;
	H53[9][9]=H53[15][15]=(5*ee+F-5*mu)+U+3*AF;
	// 代理系のハミルトニアンのホッピング
	// H31 (0,.,4,.,8,.,12,.,16,.,20,...,23)
	H31[0][1]=H31[1][0]=tt;      H31[0][2]=H31[2][0]=tt;      H31[1][3]=H31[3][1]=-tt;     H31[2][3]=H31[3][2]=-tt;
	H31[4][5]=H31[5][4]=-tt;     H31[4][6]=H31[6][4]=tt;      H31[5][7]=H31[7][5]=tt;      H31[6][7]=H31[7][6]=-tt;
	H31[8][9]=H31[9][8]=-tt;     H31[8][10]=H31[10][8]=-tt;   H31[9][11]=H31[11][9]=tt;    H31[10][11]=H31[11][10]=tt;
	H31[12][13]=H31[13][12]=tt;  H31[12][14]=H31[14][12]=-tt; H31[13][15]=H31[15][13]=tt;  H31[14][15]=H31[15][14]=-tt;
	H31[16][17]=H31[17][16]=tt;  H31[16][18]=H31[18][16]=tt;  H31[17][19]=H31[19][17]=tt;  H31[18][19]=H31[19][18]=tt;
	H31[20][21]=H31[21][20]=-tt; H31[20][22]=H31[22][20]=tt;  H31[21][23]=H31[23][21]=-tt; H31[22][23]=H31[23][22]=tt;
	
	H31[0][3]  =H31[3][0]  =ttn;  H31[1][2]  =H31[2][1]  =-ttn;
	H31[4][7]  =H31[7][4] =ttn;   H31[5][6]  =H31[6][5] =ttn;
	H31[8][11] =H31[11][8]=ttn;   H31[9][10] =H31[10][9]=-ttn;
	H31[12][15]=H31[15][12]=-ttn; H31[13][14]=H31[14][13]=ttn;
	H31[16][19]=H31[19][16]=-ttn; H31[17][18]=H31[18][17]=-ttn;
	H31[20][23]=H31[23][20]=-ttn; H31[21][22]=H31[22][21]=ttn;
	
	H31[0][8]=H31[8][0]=-tt;     H31[0][12]=H31[12][0]=-tt;   H31[4][8]=H31[8][4]=-tt;     H31[4][12]=H31[12][4]=tt;
	H31[8][16]=H31[16][8]=tt;    H31[8][20]=H31[20][8]=tt;    H31[12][16]=H31[16][12]=-tt; H31[12][20]=H31[20][12]=tt;
	
	H31[1][9]=H31[9][1]=tt;      H31[1][13]=H31[13][1]=-tt;   H31[5][9]=H31[9][5]=-tt;     H31[5][13]=H31[13][5]=-tt;
	H31[9][17]=H31[17][9]=-tt;   H31[9][21]=H31[21][9]=tt;    H31[13][17]=H31[17][13]=-tt; H31[13][21]=H31[21][13]=-tt;
	
	H31[2][10]=H31[10][2]=tt;    H31[2][14]=H31[14][2]=tt;    H31[6][10]=H31[10][6]=tt;    H31[6][14]=H31[14][6]=-tt;
	H31[10][18]=H31[18][10]=-tt; H31[10][22]=H31[22][10]=-tt; H31[14][18]=H31[18][14]=tt;  H31[14][22]=H31[22][14]=-tt;
	
	H31[3][11]=H31[11][3]=-tt;   H31[3][15]=H31[15][3]=tt;    H31[7][11]=H31[11][7]=-tt;   H31[7][15]=H31[15][7]=-tt;
	H31[11][19]=H31[19][11]=-tt; H31[11][23]=H31[23][11]=-tt; H31[15][19]=H31[19][15]=-tt; H31[15][23]=H31[23][15]=tt;
	
	H31[0][4]=H31[4][0]=-ttn;    H31[0][16]=H31[16][0]=-ttn; H31[4][20]=H31[20][4]=-ttn;    H31[16][20]=H31[20][16]=-ttn;
	H31[1][5]=H31[5][1]=ttn;     H31[1][17]=H31[17][1]=-ttn; H31[5][21]=H31[21][5]=-ttn;    H31[17][21]=H31[21][17]=ttn;
	H31[2][6]=H31[6][2]=-ttn;    H31[2][18]=H31[18][2]=-ttn; H31[6][22]=H31[22][6]=-ttn;    H31[18][22]=H31[22][18]=-ttn;
	H31[3][7]=H31[7][3]=-ttn;    H31[3][19]=H31[19][3]=ttn;  H31[7][23]=H31[23][7]=ttn;     H31[19][23]=H31[23][19]=-ttn;
	// H32 (0,.,4,.,8,.,12,.,16,.,20,...,23)
	H32[0][1]=H32[1][0]=tt;      H32[0][2]=H32[2][0]=-tt;     H32[1][3]=H32[3][1]=tt;      H32[2][3]=H32[3][2]=-tt;
	H32[4][5]=H32[5][4]=tt;      H32[4][6]=H32[6][4]=tt;      H32[5][7]=H32[7][5]=tt;      H32[6][7]=H32[7][6]=tt;
	H32[8][9]=H32[9][8]=tt;      H32[8][10]=H32[10][8]=tt;    H32[9][11]=H32[11][9]=-tt;   H32[10][11]=H32[11][10]=-tt;
	H32[12][13]=H32[13][12]=-tt; H32[12][14]=H32[14][12]=tt;  H32[13][15]=H32[15][13]=-tt; H32[14][15]=H32[15][14]=tt;
	H32[16][17]=H32[17][16]=-tt; H32[16][18]=H32[18][16]=tt;  H32[17][19]=H32[19][17]=tt;  H32[18][19]=H32[19][18]=-tt;
	H32[20][21]=H32[21][20]=-tt; H32[20][22]=H32[22][20]=-tt; H32[21][23]=H32[23][21]=tt;  H32[22][23]=H32[23][22]=tt;
	
	H32[0][3]=H32[3][0]=-ttn;     H32[1][2]=H32[2][1]=ttn;
	H32[4][7]=H32[7][4]=-ttn;     H32[5][6]=H32[6][5]=-ttn;
	H32[8][11]=H32[11][8]=ttn;    H32[9][10]=H32[10][9]=-ttn;
	H32[12][15]=H32[15][12]=-ttn; H32[13][14]=H32[14][13]=ttn;
	H32[16][19]=H32[19][16]=ttn;  H32[17][18]=H32[18][17]=ttn;
	H32[20][23]=H32[23][20]=ttn;  H32[21][22]=H32[22][21]=-ttn;
	
	H32[0][8]=H32[8][0]=-tt;     H32[0][12]=H32[12][0]=tt;    H32[4][8]=H32[8][4]=-tt;     H32[4][12]=H32[12][4]=-tt;
	H32[8][16]=H32[16][8]=-tt;   H32[8][20]=H32[20][8]=-tt;   H32[12][16]=H32[16][12]=-tt; H32[12][20]=H32[20][12]=tt;
	
	H32[1][9]=H32[9][1]=-tt;     H32[1][13]=H32[13][1]=-tt;   H32[5][9]=H32[9][5]=-tt;     H32[5][13]=H32[13][5]=tt;
	H32[9][15]=H32[15][7]=tt;    H32[9][21]=H32[21][9]=tt;    H32[13][17]=H32[17][13]=-tt; H32[13][21]=H32[21][13]=tt;
	
	H32[2][10]=H32[10][2]=tt;    H32[2][14]=H32[14][2]=-tt;   H32[6][10]=H32[10][6]=-tt;   H32[6][14]=H32[14][6]=-tt;
	H32[10][16]=H32[16][8]=-tt;  H32[10][22]=H32[22][10]=tt;  H32[14][18]=H32[18][14]=-tt; H32[14][22]=H32[22][14]=-tt;
	
	H32[3][11]=H32[11][3]=tt;    H32[3][15]=H32[15][3]=tt;    H32[7][11]=H32[11][7]=tt;    H32[7][15]=H32[15][7]=-tt;
	H32[11][17]=H32[17][9]=-tt;  H32[11][23]=H32[23][11]=-tt; H32[15][19]=H32[19][15]=tt;  H32[15][23]=H32[23][15]=-tt;
	
	H32[0][4]=H32[4][0]=-ttn;    H32[0][16]=H32[16][0]=ttn;  H32[4][20]=H32[20][4]=ttn;     H32[16][20]=H32[20][16]=-ttn;
	H32[1][5]=H32[5][1]=-ttn;    H32[1][17]=H32[17][1]=-ttn; H32[5][21]=H32[21][5]=-ttn;    H32[17][21]=H32[21][17]=-ttn;
	H32[2][6]=H32[6][2]=ttn;     H32[2][18]=H32[18][2]=-ttn; H32[6][22]=H32[22][6]=-ttn;    H32[18][22]=H32[22][18]=ttn;
	H32[3][7]=H32[7][3]=-ttn;    H32[3][19]=H32[19][3]=-ttn; H32[7][23]=H32[23][7]=-ttn;    H32[19][23]=H32[23][19]=-ttn;
	// [4,2](0,.,6,.,12,.,18,.,24,.,30,...,35)
	H42[0][2]=H42[2][0]=-tt; H42[0][3]=H42[3][0]=-tt; H42[1][2]=H42[2][1]=-tt; H42[1][3]=H42[3][1]=tt;
	H42[2][4]=H42[4][2]=tt;  H42[2][5]=H42[5][2]=tt;  H42[3][4]=H42[4][3]=-tt; H42[3][5]=H42[5][3]=tt;
	
	H42[6][8]=H42[8][6]=tt;    H42[6][9]=H42[9][6]=-tt;   H42[7][8]=H42[8][7]=-tt;   H42[7][9]=H42[9][7]=-tt;
	H42[8][10]=H42[10][8]=-tt; H42[8][11]=H42[11][8]=tt;  H42[9][10]=H42[10][9]=-tt; H42[9][11]=H42[11][9]=-tt;
	
	H42[12][14]=H42[14][12]=tt;  H42[12][15]=H42[15][12]=tt;  H42[13][14]=H42[14][13]=tt; H42[13][15]=H42[15][13]=-tt;
	H42[14][16]=H42[16][14]=-tt; H42[14][17]=H42[17][14]=-tt; H42[15][16]=H42[16][15]=tt; H42[15][17]=H42[17][15]=-tt;
	
	H42[18][20]=H42[20][18]=tt; H42[18][21]=H42[21][18]=tt;  H42[19][20]=H42[20][19]=-tt; H42[19][21]=H42[21][19]=tt;
	H42[20][22]=H42[22][20]=tt; H42[20][23]=H42[23][20]=-tt; H42[21][22]=H42[22][21]=-tt; H42[21][23]=H42[23][21]=-tt;
	
	H42[24][26]=H42[26][24]=tt; H42[24][27]=H42[27][24]=-tt; H42[25][26]=H42[26][25]=tt; H42[25][27]=H42[27][25]=tt;
	H42[26][28]=H42[28][26]=tt; H42[26][29]=H42[29][26]=tt;  H42[27][28]=H42[28][27]=tt; H42[27][29]=H42[29][27]=-tt;
	
	H42[30][32]=H42[32][30]=-tt; H42[30][33]=H42[33][30]=-tt; H42[31][32]=H42[32][31]=tt; H42[31][33]=H42[33][31]=-tt;
	H42[32][34]=H42[34][32]=-tt; H42[32][35]=H42[35][32]=tt;  H42[33][34]=H42[34][33]=tt; H42[33][35]=H42[35][33]=tt;
	
	H42[0][1]=H42[1][0]=-ttn;     H42[0][4]=H42[4][0]=-ttn;     H42[1][5]=H42[5][1]=-ttn;     H42[4][5]=H42[5][4]=-ttn;
	H42[6][7]=H42[7][6]=ttn;      H42[6][10]=H42[10][6]=-ttn;   H42[7][11]=H42[11][7]=-ttn;   H42[10][11]=H42[11][10]=ttn;
	H42[12][13]=H42[13][12]=-ttn; H42[12][16]=H42[16][12]=-ttn; H42[13][17]=H42[17][13]=-ttn; H42[16][17]=H42[17][16]=-ttn;
	H42[18][19]=H42[19][18]=ttn;  H42[18][22]=H42[22][18]=ttn;  H42[20][23]=H42[23][19]=ttn;  H42[22][23]=H42[23][22]=ttn;
	H42[24][25]=H42[25][24]=-ttn; H42[24][28]=H42[28][24]=ttn;  H42[26][29]=H42[29][26]=ttn;  H42[28][29]=H42[29][28]=ttn;
	H42[30][31]=H42[31][30]=ttn;  H42[30][34]=H42[34][30]=ttn;  H42[32][35]=H42[35][32]=ttn;  H42[34][35]=H42[35][34]=-ttn;
	
	H42[0][12]=H42[12][0]=tt;    H42[0][18]=H42[18][0]=tt;    H42[6][12]=H42[12][6]=-tt;   H42[6][18]=H42[18][6]=tt;
	H42[12][24]=H42[24][12]=tt;  H42[12][30]=H42[30][12]=-tt; H42[18][24]=H42[24][18]=-tt; H42[18][30]=H42[30][18]=-tt;
	
	H42[1][13]=H42[13][1]=tt;    H42[1][19]=H42[19][1]=-tt;   H42[7][13]=H42[13][7]=tt;    H42[7][19]=H42[19][7]=tt;
	H42[13][25]=H42[25][13]=tt;  H42[13][31]=H42[31][13]=tt;  H42[19][25]=H42[25][19]=tt;  H42[19][31]=H42[31][19]=-tt;
	
	H42[2][14]=H42[14][2]=-tt;   H42[2][20]=H42[21][2]=-tt;   H42[8][14]=H42[14][8]=-tt;   H42[8][20]=H42[20][8]=tt;
	H42[14][26]=H42[26][14]=tt;  H42[14][32]=H42[32][14]=tt;  H42[20][26]=H42[26][20]=-tt; H42[20][32]=H42[32][20]=tt;
	
	H42[3][15]=H42[15][3]=-tt;   H42[3][21]=H42[21][3]=-tt;   H42[9][15]=H42[15][9]=tt;    H42[9][21]=H42[21][9]=-tt;
	H42[15][27]=H42[27][15]=-tt; H42[14][33]=H42[33][14]=tt;  H42[21][27]=H42[27][21]=tt;  H42[21][33]=H42[33][21]=tt;
	
	H42[4][16]=H42[16][4]=tt;    H42[4][22]=H42[22][4]=-tt;   H42[10][16]=H42[16][10]=-tt; H42[10][22]=H42[22][10]=-tt;
	H42[16][28]=H42[28][16]=-tt; H42[16][34]=H42[34][16]=tt;  H42[22][28]=H42[28][22]=-tt; H42[22][34]=H42[34][22]=-tt;
	
	H42[5][17]=H42[17][5]=tt;    H42[5][23]=H42[23][5]=tt;    H42[11][17]=H42[17][11]=tt;  H42[11][23]=H42[23][11]=-tt;
	H42[17][29]=H42[29][17]=-tt; H42[17][35]=H42[35][17]=-tt; H42[23][29]=H42[29][23]=tt;  H42[23][35]=H42[35][23]=-tt;
	
	H42[0][6]=H42[6][0]=ttn;    H42[0][24]=H42[24][0]=ttn;  H42[6][30]=H42[30][6]=ttn;    H42[24][30]=H42[30][24]=ttn;
	H42[1][7]=H42[7][1]=-ttn;   H42[1][25]=H42[25][1]=ttn;  H42[7][31]=H42[31][7]=ttn;    H42[25][31]=H42[31][25]=-ttn;
	H42[2][8]=H42[8][2]=-ttn;   H42[2][26]=H42[26][2]=-ttn; H42[8][32]=H42[32][8]=-ttn;   H42[26][32]=H42[32][26]=-ttn;
	H42[3][9]=H42[9][3]=ttn;    H42[3][27]=H42[27][3]=ttn;  H42[9][33]=H42[33][9]=ttn;    H42[27][33]=H42[33][27]=ttn;
	H42[4][10]=H42[10][4]=ttn;  H42[4][28]=H42[28][4]=-ttn; H42[10][34]=H42[34][10]=-ttn; H42[28][34]=H42[34][28]=ttn;
	H42[5][11]=H42[11][5]=-ttn; H42[5][29]=H42[29][5]=-ttn; H42[11][35]=H42[35][11]=-ttn; H42[29][35]=H42[35][29]=-ttn;
	// H52 (0,.,6,.,12,.,18,...,24) (u1:28,.,34,.,40,.,46,...,51)
	H52[0][2]=H52[2][0]=tt;       H52[0][3]=H52[3][0]=tt;       H52[1][2]=H52[2][1]=-tt;      H52[1][3]=H52[3][1]=tt;
	H52[2][4]=H52[4][2]=tt;       H52[2][5]=H52[5][2]=-tt;      H52[3][4]=H52[4][3]=-tt;      H52[3][5]=H52[5][3]=-tt;
	H52[0][1]=H52[1][0]=ttn;      H52[0][4]=H52[4][0]=ttn;      H52[1][4]=H52[4][1]=ttn;      H52[4][5]=H52[5][4]=ttn;
	
	H52[6][8]=H52[8][6]=tt;       H52[6][9]=H52[9][6]=-tt;      H52[7][8]=H52[8][7]=tt;       H52[8][10]=H52[37][35]=tt;
	H52[8][10]=H52[10][8]=tt;    H52[8][11]=H52[11][8]=tt;     H52[9][10]=H52[10][9]=tt;     H52[9][11]=H52[11][9]=-tt;
	H52[6][7]=H52[7][6]=-ttn;     H52[6][10]=H52[10][6]=ttn;    H52[7][10]=H52[10][7]=ttn;    H52[10][11]=H52[11][10]=-ttn;
	
	H52[12][14]=H52[14][12]=-tt;  H52[12][15]=H52[15][12]=-tt;  H52[13][14]=H52[14][13]=tt;   H52[13][15]=H52[15][13]=-tt;
	H52[14][16]=H52[16][14]=-tt;  H52[14][17]=H52[17][14]=tt;   H52[15][16]=H52[16][15]=tt;   H52[15][17]=H52[17][15]=tt;
	H52[12][13]=H52[13][12]=ttn;  H52[12][16]=H52[16][12]=ttn;  H52[13][17]=H52[17][13]=ttn;  H52[16][17]=H52[17][16]=ttn;
	
	H52[18][20]=H52[20][18]=-tt;  H52[18][21]=H52[21][18]=tt;   H52[19][20]=H52[20][19]=tt;   H52[19][21]=H52[21][19]=tt;
	H52[20][22]=H52[22][20]=tt;   H52[20][23]=H52[23][20]=-tt;  H52[21][22]=H52[22][21]=tt;   H52[21][23]=H52[23][21]=tt;
	H52[18][19]=H52[19][18]=ttn;  H52[18][22]=H52[22][18]=-ttn; H52[19][23]=H52[23][19]=-ttn; H52[22][23]=H52[23][22]=ttn;
	
	H52[0][6]=H52[6][0]=-tt;   H52[0][12]=H52[12][0]=-tt;  H52[6][18]=H52[18][6]=tt;    H52[12][18]=H52[18][12]=tt;
	H52[1][7]=H52[7][1]=tt;    H52[1][13]=H52[13][1]=-tt;  H52[7][19]=H52[19][7]=-tt;   H52[13][19]=H52[19][13]=tt;
	H52[2][8]=H52[8][2]=-tt;   H52[2][14]=H52[14][2]=tt;   H52[8][20]=H52[20][8]=-tt;   H52[14][20]=H52[20][14]=tt;
	H52[3][9]=H52[9][3]=tt;    H52[3][15]=H52[15][3]=tt;   H52[9][21]=H52[21][9]=-tt;   H52[15][21]=H52[21][15]=-tt;
	H52[4][10]=H52[10][4]=-tt; H52[4][16]=H52[16][4]=-tt;  H52[10][22]=H52[22][10]=-tt; H52[16][22]=H52[22][16]=-tt;
	H52[5][11]=H52[11][5]=tt;  H52[5][17]=H52[17][5]=-tt;  H52[11][23]=H52[23][11]=tt;  H52[17][23]=H52[23][17]=-tt;
	
	H52[0][18]=H52[18][0]=-ttn; H52[6][12]=H52[12][6]=ttn;
	H52[1][19]=H52[19][1]=-ttn; H52[7][13]=H52[13][7]=-ttn;
	H52[2][20]=H52[20][2]=ttn;  H52[8][14]=H52[14][8]=-ttn;
	H52[3][21]=H52[21][3]=-ttn; H52[9][15]=H52[15][9]=ttn;
	H52[4][22]=H52[22][4]=ttn;  H52[10][16]=H52[16][10]=ttn;
	H52[5][23]=H52[23][5]=ttn;  H52[11][17]=H52[17][11]=-ttn;
	// H53 (0,.,6,.,12,.,18,...,24) (d1:28,.,34,.,40,.,46,...,51)
	H53[0][2]=H53[2][0]=-tt;      H53[0][3]=H53[3][0]=tt;      H53[1][2]=H53[2][1]=tt;      H53[1][3]=H53[3][1]=tt;
	H53[2][4]=H53[4][2]=tt;       H53[2][5]=H53[5][2]=-tt;     H53[3][4]=H53[4][3]=tt;      H53[3][5]=H53[5][3]=tt;
	H53[0][1]=H53[1][0]=ttn;      H53[0][4]=H53[4][0]=-ttn;    H53[1][5]=H53[5][1]=-ttn;    H53[4][5]=H53[5][4]=ttn;
	
	H53[34][36]=H53[36][34]=tt;   H53[34][37]=H53[37][34]=tt;  H53[35][36]=H53[36][35]=-tt; H53[35][37]=H53[37][35]=tt;
	H53[36][38]=H53[38][36]=tt;   H53[36][39]=H53[39][36]=-tt; H53[37][38]=H53[38][37]=-tt; H53[37][39]=H53[39][37]=-tt;
	H53[34][35]=H53[35][34]=ttn;  H53[34][38]=H53[38][34]=ttn; H53[35][39]=H53[39][35]=ttn; H53[38][39]=H53[39][38]=ttn;
	
	H53[40][42]=H53[42][40]=tt;   H53[40][43]=H53[43][40]=-tt; H53[41][42]=H53[42][41]=tt;  H53[41][43]=H53[43][41]=tt;
	H53[42][44]=H53[44][42]=tt;   H53[42][45]=H53[45][42]=tt;  H53[43][44]=H53[44][43]=tt;  H53[43][45]=H53[45][43]=-tt;
	H53[40][41]=H53[41][40]=-ttn; H53[40][44]=H53[44][40]=ttn; H53[41][45]=H53[45][41]=ttn; H53[44][45]=H53[45][44]=-ttn;
	
	H53[46][48]=H53[48][46]=-tt;  H53[46][49]=H53[49][46]=-tt; H53[47][48]=H53[48][47]=tt;  H53[47][49]=H53[49][47]=-tt;
	H53[48][50]=H53[50][48]=-tt;  H53[48][51]=H53[51][48]=tt;  H53[49][50]=H53[50][49]=tt;  H53[49][51]=H53[51][49]=tt;
	H53[46][47]=H53[47][46]=ttn;  H53[46][50]=H53[50][46]=ttn; H53[47][51]=H53[51][47]=ttn; H53[50][51]=H53[51][50]=ttn;
	
	H53[28][34]=H53[34][28]=-tt;  H53[28][40]=H53[40][28]=tt;  H53[34][46]=H53[46][34]=-tt; H53[40][46]=H53[46][40]=tt;
	H53[29][35]=H53[35][29]=-tt;  H53[29][41]=H53[41][29]=-tt; H53[35][47]=H53[47][35]=-tt; H53[41][47]=H53[47][41]=-tt;
	H53[30][36]=H53[36][30]=tt;   H53[30][42]=H53[42][30]=-tt; H53[36][48]=H53[48][36]=tt;  H53[42][48]=H53[48][42]=-tt;
	H53[31][37]=H53[37][31]=-tt;  H53[31][43]=H53[43][31]=-tt; H53[37][49]=H53[49][37]=tt;  H53[43][49]=H53[49][43]=tt;
	H53[32][38]=H53[38][32]=tt;   H53[32][44]=H53[44][32]=-tt; H53[38][50]=H53[50][38]=-tt; H53[44][50]=H53[50][44]=tt;
	H53[33][39]=H53[39][33]=tt;   H53[33][45]=H53[45][33]=tt;  H53[39][51]=H53[51][39]=-tt; H53[45][51]=H53[51][45]=-tt;
	
	H53[28][46]=H53[46][28]=ttn;  H53[34][40]=H53[40][34]=-ttn;
	H53[29][47]=H53[47][29]=ttn;  H53[35][41]=H53[41][35]=ttn;
	H53[30][48]=H53[48][30]=ttn;  H53[36][42]=H53[42][36]=-ttn;
	H53[31][49]=H53[49][31]=-ttn; H53[37][43]=H53[43][37]=ttn;
	H53[32][50]=H53[50][32]=-ttn; H53[38][44]=H53[44][38]=-ttn;
	H53[33][51]=H53[51][33]=-ttn; H53[39][45]=H53[45][39]=ttn;
	
	// 生成消滅演算子の確認
	int N_u21_p,N_u21_m,N_d21_p,N_d21_m,N_u32_p,N_u32_m,N_d31_p,N_d31_m;
	N_u21_p=N_u21_m=N_d21_p=N_d21_m=N_u32_p=N_u32_m=N_d31_p=N_d31_m=0;
	for(x=0;x<=1;++x){
		for(y=0;y<=1;++y){
			for(i=0;i<=35;++i){
				for(j=0;j<=23;++j){
					if(cu_21[x][y][i][j]>0.1)  N_u21_p+=1;
					if(cu_21[x][y][i][j]<-0.1) N_u21_m+=1;
					if(cd_21[x][y][i][j]>0.1)  N_u21_p+=1;
					if(cd_21[x][y][i][j]<-0.1) N_u21_m+=1;
					if(cu_32[x][y][i][j]>0.1)  N_u21_p+=1;
					if(cu_32[x][y][i][j]<-0.1) N_u21_m+=1;
					if(cd_31[x][y][i][j]>0.1)  N_u21_p+=1;
					if(cd_31[x][y][i][j]<-0.1) N_u21_p+=1;
					
				};
			};
		};
	};
	cout << "p : (u21,d21,u32,d31)=("<<N_u21_p<<","<<N_d21_p<<","<<N_u32_p<<","<<N_d31_p<<")\n";
	cout << "m : (u21,d21,u32,d31)=("<<N_u21_m<<","<<N_d21_m<<","<<N_u32_m<<","<<N_d31_m<<")\n";
	
	
	
	
	
	
};
