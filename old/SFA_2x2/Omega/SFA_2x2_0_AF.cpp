// SFA, 2x2サイト, 超伝導

#include <iostream.h>
#include <fstream.h>
#include <math.h>
//#include <process.h>
#include "dsyev.h"

main()
{
	int i,j,n,m,N,n_omega,x,xx,y,yy,kx,kkx,ky,kky; int n_AF;
	double Kx,KKx,Ky,KKy; const double pi=3.1415926535897932;
	double cu_0[2][2][70][56],cd_0[2][2][70][56],cu_d1[2][2][56][70],cd_u1[2][2][56][70];
	double e,t,tn,U,mu,h; double ee,tt,ttn,F,AF,Px,Py; double alpha; double AFa;
	double H0[70][70],Hu1[56][56],Hd1[56][56]; double E0[70],Eu1[56],Ed1[56];
	double work[209]; char jobz='V'; char uplo='U'; int info;
	double GRI0u[4][4],GRI0d[4][4];
	double Au[4][4][56],Ad[4][4][56],Bu[4][4][56],Bd[4][4][56],au[2][2],ad[2][2],bu[2][2],bd[2][2];
	double GRu[4][4],GRd[4][4],gRu[4],gRd[4],SEu[4][4],SEd[4][4],GIu[4][4],GId[4][4],gIu[4],gId[4],band;
	double omega,Omega_r,Omega_t[13],Omega,Sur,Sdr,Sug,Sdg,Sr,Sg;
	int Nur,Ndr,Nug,Ndg;
	double AAu[4][4],BBu[4][4],AAd[4][4],BBd[4][4],Iu[4][4],Id[4][4];
	// 生成消滅演算子
	for(x=0;x<=1;++x){
		for(y=0;y<=1;++y){
			for(i=0;i<=69;++i){
				for(j=0;j<=55;++j){
					cu_0[x][y][i][j]=cd_0[x][y][i][j]=cu_d1[x][y][j][i]=cd_u1[x][y][j][i]=0.0;
				};
			};
		};
	};
	// u : [0,0](0:0) [1,0](u1:0,...3)
	cu_0[0][0][0][0]=cu_0[1][0][0][1]=cu_0[0][1][0][2]=cu_0[1][1][0][3]=1.0;
	// d : [0,0](0:0) [1,1](d1:0,...3)
	cd_0[0][0][0][0]=cd_0[1][0][0][1]=cd_0[0][1][0][2]=cd_0[1][1][0][3]=1.0;
	// d : [1,0](u1:0,...3) [2,1](0: 1,.,5,.,9,.,13,...,16)
	cd_u1[0][0][0][1]=-1.0; cd_u1[0][0][1][5]=cd_u1[0][0][2][9]=cd_u1[0][0][3][13]=1.0;
	cd_u1[1][0][0][2]=cd_u1[1][0][1][6]=-1.0; cd_u1[1][0][2][10]=cd_u1[1][0][3][14]=1.0;
	cd_u1[0][1][0][3]=cd_u1[0][1][1][7]=cd_u1[0][1][2][11]=-1.0; cd_u1[0][1][3][15]=1.0;
	cd_u1[1][1][0][4]=cd_u1[1][1][1][8]=cd_u1[1][1][2][12]=cd_u1[1][1][3][16]=-1.0;
	// u : [1,1](d1:0,...,3) [2,1](0:1,.,5,.,9,.,13,...,16)
	cu_d1[0][0][0][1]=cu_d1[0][0][1][2]=cu_d1[0][0][2][3]=cu_d1[0][0][3][4]=1.0;
	cu_d1[1][0][0][5]=-1.0; cu_d1[1][0][1][6]=cu_d1[1][0][2][7]=cu_d1[1][0][3][8]=1.0;
	cu_d1[0][1][0][9]=cu_d1[0][1][1][10]=-1.0; cu_d1[0][1][2][11]=cu_d1[0][1][3][12]=1.0;
	cu_d1[1][1][0][13]=cu_d1[1][1][1][14]=cu_d1[1][1][2][15]=-1.0; cu_d1[1][1][3][16]=1.0;
	// u [2,1](0:1,.,5,.,9,.,13,...,16) [3,1](u1:4,.,8,.,12,.,16,.,20,.,24,...,27)
	cu_0[0][0][5][4]=cu_0[0][0][6][5]=cu_0[0][0][7][6]=cu_0[0][0][8][7]=1.0;
	cu_0[0][0][9][8]=cu_0[0][0][10][9]=cu_0[0][0][11][10]=cu_0[0][0][12][11]=1.0;
	cu_0[0][0][13][12]=cu_0[0][0][14][13]=cu_0[0][0][15][14]=cu_0[0][0][16][15]=1.0;
	
	cu_0[1][0][1][4]=1.0; cu_0[1][0][2][5]=cu_0[1][0][3][6]=cu_0[1][0][4][7]=-1.0;
	cu_0[1][0][9][16]=-1.0; cu_0[1][0][10][17]=cu_0[1][0][11][18]=cu_0[1][0][12][19]=1.0;
	cu_0[1][0][13][20]=-1.0; cu_0[1][0][14][21]=cu_0[1][0][15][22]=cu_0[1][0][16][23]=1.0;
	
	cu_0[0][1][1][8]=cu_0[0][1][2][9]=1.0; cu_0[0][1][3][10]=cu_0[0][1][4][11]=-1.0;
	cu_0[0][1][5][16]=cu_0[0][1][6][17]=1.0; cu_0[0][1][7][18]=cu_0[0][1][8][19]=-1.0;
	cu_0[0][1][13][24]=cu_0[0][1][14][25]=-1.0; cu_0[0][1][15][26]=cu_0[0][1][16][27]=1.0;
	
	cu_0[1][1][1][12]=cu_0[1][1][2][13] =cu_0[1][1][3][14] =1.0; cu_0[1][1][4][15] =-1.0;
	cu_0[1][1][5][20]=cu_0[1][1][6][21] =cu_0[1][1][7][22] =1.0; cu_0[1][1][8][23] =-1.0;
	cu_0[1][1][9][24]=cu_0[1][1][10][25]=cu_0[1][1][11][26]=1.0; cu_0[1][1][12][27]=-1.0;
	// d [2,1](0:1,.,5,.,9,.,13,...,16) [3,2](d1:4,.,8,.,12,.,16,.,20,.,24,...27)
	cd_0[0][0][2][4] =cd_0[0][0][3][8]  =cd_0[0][0][4][12] =-1.0;
	cd_0[0][0][6][5] =cd_0[0][0][7][9]  =cd_0[0][0][8][13] =1.0;
	cd_0[0][0][10][6]=cd_0[0][0][11][10]=cd_0[0][0][12][14]=1.0;
	cd_0[0][0][14][7]=cd_0[0][0][15][11]=cd_0[0][0][16][15]=1.0;
	
	cd_0[1][0][1][4]=1.0; cd_0[1][0][3][16]=cd_0[1][0][4][20]=-1.0;
	cd_0[1][0][5][5]=1.0; cd_0[1][0][7][17]=cd_0[1][0][8][21]=-1.0;
	cd_0[1][0][9][6]=-1.0; cd_0[1][0][11][18]=cd_0[1][0][12][22]=1.0;
	cd_0[1][0][13][7]=-1.0; cd_0[1][0][15][19]=cd_0[1][0][16][23]=1.0;
	
	cd_0[0][1][1][8]  =cd_0[0][1][2][16] =1.0;  cd_0[0][1][4][24] =-1.0;
	cd_0[0][1][5][9]  =cd_0[0][1][6][17] =1.0;  cd_0[0][1][8][25] =-1.0;
	cd_0[0][1][9][10] =cd_0[0][1][10][18]=1.0;  cd_0[0][1][12][26]=-1.0;
	cd_0[0][1][13][11]=cd_0[0][1][14][19]=-1.0; cd_0[0][1][16][27] =1.0;
	
	cd_0[1][1][1][12] =cd_0[1][1][2][20] =cd_0[1][1][3][24] =1.0;
	cd_0[1][1][5][13] =cd_0[1][1][6][21] =cd_0[1][1][7][25] =1.0;
	cd_0[1][1][9][14] =cd_0[1][1][10][22]=cd_0[1][1][11][26]=1.0;
	cd_0[1][1][13][15]=cd_0[1][1][14][23]=cd_0[1][1][15][27]=1.0;
	// d [3,1](u1:4,.,8,.,12,.,16,.,20,.,24,...,27) [4,2](0:17,.,23,.,29,.,35,.,41,.,47,...,52)
	cd_u1[0][0][5][17]=cd_u1[0][0][6][18]=cd_u1[0][0][7][19]=-1.0;
	cd_u1[0][0][9][23]=cd_u1[0][0][10][24]=cd_u1[0][0][11][25]=-1.0;
	cd_u1[0][0][13][29]=cd_u1[0][0][14][30]=cd_u1[0][0][15][31]=-1.0;
	cd_u1[0][0][17][35]=cd_u1[0][0][18][36]=cd_u1[0][0][19][37]=1.0;
	cd_u1[0][0][21][41]=cd_u1[0][0][22][42]=cd_u1[0][0][23][43]=1.0;
	cd_u1[0][0][25][47]=cd_u1[0][0][26][48]=cd_u1[0][0][27][49]=1.0;
	
	cd_u1[1][0][4][17]=-1.0; cd_u1[1][0][6][20]=cd_u1[1][0][7][21]=1.0;
	cd_u1[1][0][8][23]=1.0; cd_u1[1][0][10][26]=cd_u1[1][0][11][27]=-1.0;
	cd_u1[1][0][12][29]=1.0; cd_u1[1][0][14][32]=cd_u1[1][0][15][33]=-1.0;
	cd_u1[1][0][16][35]=1.0; cd_u1[1][0][18][38]=cd_u1[1][0][19][39]=-1.0;
	cd_u1[1][0][20][41]=1.0; cd_u1[1][0][22][44]=cd_u1[1][0][23][45]=-1.0;
	cd_u1[1][0][24][47]=-1.0; cd_u1[1][0][26][50]=cd_u1[1][0][27][51]=1.0;
	
	cd_u1[0][1][4][18]=cd_u1[0][1][5][20]=-1.0; cd_u1[0][1][7][22]=1.0;
	cd_u1[0][1][8][24]=cd_u1[0][1][9][26]=-1.0; cd_u1[0][1][11][28]=1.0;
	cd_u1[0][1][12][30]=cd_u1[0][1][13][32]=1.0; cd_u1[0][1][15][34]=-1.0;
	cd_u1[0][1][16][36]=cd_u1[0][1][17][38]=-1.0; cd_u1[0][1][19][40]=1.0;
	cd_u1[0][1][20][42]=cd_u1[0][1][21][44]=1.0; cd_u1[0][1][23][46]=-1.0;
	cd_u1[0][1][24][48]=cd_u1[0][1][25][50]=1.0; cd_u1[0][1][27][52]=-1.0;
	
	cd_u1[1][1][4][19]=cd_u1[1][1][5][21]=cd_u1[1][1][6][22]=-1.0;
	cd_u1[1][1][8][25]=cd_u1[1][1][9][27]=cd_u1[1][1][10][28]=-1.0;
	cd_u1[1][1][12][31]=cd_u1[1][1][13][33]=cd_u1[1][1][14][34]=-1.0;
	cd_u1[1][1][16][37]=cd_u1[1][1][17][39]=cd_u1[1][1][18][40]=-1.0;
	cd_u1[1][1][20][43]=cd_u1[1][1][21][45]=cd_u1[1][1][22][46]=-1.0;
	cd_u1[1][1][24][49]=cd_u1[1][1][25][51]=cd_u1[1][1][26][52]=-1.0;
	// u [3,2](d1:4,.,8,.,12,.,16,.,20,.,24,...,27) [4,2](0:17,.,23,.,29,.,35,.,41,.,47,...,52)
	cu_d1[0][0][5][17] =cu_d1[0][0][6][23] =cu_d1[0][0][7][29] =1.0;
	cu_d1[0][0][9][18] =cu_d1[0][0][10][24]=cu_d1[0][0][11][30]=1.0;
	cu_d1[0][0][13][19]=cu_d1[0][0][14][25]=cu_d1[0][0][15][31]=1.0;
	cu_d1[0][0][17][20]=cu_d1[0][0][18][26]=cu_d1[0][0][19][32]=1.0;
	cu_d1[0][0][21][21]=cu_d1[0][0][22][27]=cu_d1[0][0][23][33]=1.0;
	cu_d1[0][0][25][22]=cu_d1[0][0][26][28]=cu_d1[0][0][27][34]=1.0;
	
	cu_d1[1][0][4][17]=1.0; cu_d1[1][0][6][35]=cu_d1[1][0][7][41]=-1.0;
	cu_d1[1][0][8][18]=1.0; cu_d1[1][0][10][36]=cu_d1[1][0][11][42]=-1.0;
	cu_d1[1][0][12][19]=1.0; cu_d1[1][0][14][37]=cu_d1[1][0][15][43]=-1.0;
	cu_d1[1][0][16][20]=-1.0; cu_d1[1][0][18][38]=cu_d1[1][0][19][44]=1.0;
	cu_d1[1][0][20][21]=-1.0; cu_d1[1][0][22][39]=cu_d1[1][0][23][45]=1.0;
	cu_d1[1][0][24][22]=-1.0; cu_d1[1][0][26][40]=cu_d1[1][0][27][46]=1.0;
	
	cu_d1[0][1][4][23] =cu_d1[0][1][5][35] =-1.0; cu_d1[0][1][7][47] =1.0;
	cu_d1[0][1][8][24] =cu_d1[0][1][9][36] =1.0;  cu_d1[0][1][11][48]=-1.0;
	cu_d1[0][1][12][25]=cu_d1[0][1][13][37]=1.0;  cu_d1[0][1][15][49]=-1.0;
	cu_d1[0][1][16][26]=cu_d1[0][1][17][38]=1.0;  cu_d1[0][1][19][50]=-1.0;
	cu_d1[0][1][20][27]=cu_d1[0][1][21][39]=1.0;  cu_d1[0][1][23][51]=-1.0;
	cu_d1[0][1][24][28]=cu_d1[0][1][25][40]=-1.0; cu_d1[0][1][27][52]=1.0;
	
	cu_d1[1][1][4][29] =cu_d1[1][1][5][41] =cu_d1[1][1][6][47] =-1.0;
	cu_d1[1][1][8][30] =cu_d1[1][1][9][42] =cu_d1[1][1][10][48]=-1.0;
	cu_d1[1][1][12][31]=cu_d1[1][1][13][43]=cu_d1[1][1][14][49]=1.0;
	cu_d1[1][1][16][32]=cu_d1[1][1][17][44]=cu_d1[1][1][18][50]=-1.0;
	cu_d1[1][1][20][33]=cu_d1[1][1][21][45]=cu_d1[1][1][22][51]=1.0;
	cu_d1[1][1][24][34]=cu_d1[1][1][25][46]=cu_d1[1][1][26][52]=1.0;
	// u [4,2](0:17,.,23,.,29,.,35,.,41,.,47,...,52) [5,2](u1:28,.,34,.,40,.,46,...,51)
	cu_0[0][0][35][28]=cu_0[0][0][41][34]=cu_0[0][0][47][40]=1.0;
	cu_0[0][0][36][29]=cu_0[0][0][42][35]=cu_0[0][0][48][41]=1.0;
	cu_0[0][0][37][30]=cu_0[0][0][43][36]=cu_0[0][0][49][42]=1.0;
	cu_0[0][0][38][31]=cu_0[0][0][44][37]=cu_0[0][0][50][43]=1.0;
	cu_0[0][0][39][32]=cu_0[0][0][45][38]=cu_0[0][0][51][44]=1.0;
	cu_0[0][0][40][33]=cu_0[0][0][46][39]=cu_0[0][0][52][45]=1.0;
	
	cu_0[1][0][23][28]=cu_0[1][0][29][34]=1.0; cu_0[1][0][47][46]=-1.0;
	cu_0[1][0][24][29]=cu_0[1][0][30][35]=1.0; cu_0[1][0][48][47]=-1.0;
	cu_0[1][0][25][30]=cu_0[1][0][31][36]=1.0; cu_0[1][0][49][48]=-1.0;
	cu_0[1][0][26][31]=cu_0[1][0][32][37]=-1.0; cu_0[1][0][50][49]=1.0;
	cu_0[1][0][27][32]=cu_0[1][0][33][38]=-1.0; cu_0[1][0][51][50]=1.0;
	cu_0[1][0][28][33]=cu_0[1][0][34][39]=-1.0; cu_0[1][0][52][51]=1.0;
	
	cu_0[0][1][17][28]=1.0; cu_0[0][1][29][40]=cu_0[0][1][41][46]=-1.0;
	cu_0[0][1][18][29]=-1.0; cu_0[0][1][30][41]=cu_0[0][1][42][47]=1.0;
	cu_0[0][1][19][30]=-1.0; cu_0[0][1][31][42]=cu_0[0][1][43][48]=1.0;
	cu_0[0][1][20][31]=-1.0; cu_0[0][1][32][43]=cu_0[0][1][44][49]=1.0;
	cu_0[0][1][21][32]=-1.0; cu_0[0][1][33][44]=cu_0[0][1][45][50]=1.0;
	cu_0[0][1][22][33]=1.0; cu_0[0][1][34][45]=cu_0[0][1][46][51]=-1.0;
	
	cu_0[1][1][17][34]=cu_0[1][1][23][40]=cu_0[1][1][35][46]=1.0;
	cu_0[1][1][18][35]=cu_0[1][1][24][41]=cu_0[1][1][36][47]=1.0;
	cu_0[1][1][19][36]=cu_0[1][1][25][42]=cu_0[1][1][37][48]=-1.0;
	cu_0[1][1][20][37]=cu_0[1][1][26][43]=cu_0[1][1][38][49]=1.0;
	cu_0[1][1][21][38]=cu_0[1][1][27][44]=cu_0[1][1][39][50]=-1.0;
	cu_0[1][1][22][39]=cu_0[1][1][28][45]=cu_0[1][1][40][51]=-1.0;
	// d [4,2](0:17,.,23,.,29,.,35,.,41,.,47,...,52) [5,3](d1:28,.,34,.,40,.,46,...,51)
	cd_0[0][0][20][28]=cd_0[0][0][21][34]=cd_0[0][0][22][40]=-1.0;
	cd_0[0][0][26][29]=cd_0[0][0][27][35]=cd_0[0][0][28][41]=-1.0;
	cd_0[0][0][32][30]=cd_0[0][0][33][36]=cd_0[0][0][34][42]=-1.0;
	cd_0[0][0][38][31]=cd_0[0][0][39][37]=cd_0[0][0][40][43]=1.0;
	cd_0[0][0][44][32]=cd_0[0][0][45][38]=cd_0[0][0][46][44]=1.0;
	cd_0[0][0][50][33]=cd_0[0][0][51][39]=cd_0[0][0][52][45]=1.0;
	
	cd_0[1][0][18][28]=cd_0[1][0][19][34]=-1.0; cd_0[1][0][22][46]=1.0;
	cd_0[1][0][24][29]=cd_0[1][0][25][35]=1.0; cd_0[1][0][28][47]=-1.0;
	cd_0[1][0][30][30]=cd_0[1][0][31][36]=1.0; cd_0[1][0][34][48]=-1.0;
	cd_0[1][0][36][31]=cd_0[1][0][37][37]=1.0; cd_0[1][0][40][49]=-1.0;
	cd_0[1][0][42][32]=cd_0[1][0][43][38]=1.0; cd_0[1][0][46][50]=-1.0;
	cd_0[1][0][48][33]=cd_0[1][0][49][39]=-1.0; cd_0[1][0][52][51]=1.0;
	
	cd_0[0][1][17][28]=1.0; cd_0[0][1][19][40]=cd_0[0][1][21][46]=-1.0;
	cd_0[0][1][23][29]=1.0; cd_0[0][1][25][41]=cd_0[0][1][27][47]=-1.0;
	cd_0[0][1][29][30]=-1.0; cd_0[0][1][31][42]=cd_0[0][1][33][48]=1.0;
	cd_0[0][1][35][31]=1.0; cd_0[0][1][37][43]=cd_0[0][1][39][49]=-1.0;
	cd_0[0][1][41][32]=-1.0; cd_0[0][1][43][44]=cd_0[0][1][45][50]=1.0;
	cd_0[0][1][47][33]=-1.0; cd_0[0][1][49][45]=cd_0[0][1][51][51]=1.0;
	
	cd_0[1][1][17][34]=cd_0[1][1][18][40]=cd_0[1][1][20][46]=1.0;
	cd_0[1][1][23][35]=cd_0[1][1][24][41]=cd_0[1][1][26][47]=1.0;
	cd_0[1][1][29][36]=cd_0[1][1][30][42]=cd_0[1][1][32][48]=1.0;
	cd_0[1][1][35][37]=cd_0[1][1][36][43]=cd_0[1][1][38][49]=1.0;
	cd_0[1][1][41][38]=cd_0[1][1][42][44]=cd_0[1][1][44][50]=1.0;
	cd_0[1][1][47][39]=cd_0[1][1][48][45]=cd_0[1][1][50][51]=1.0;
	// d [5,2](u1:28,.,34,.,40,.,46,...,51) [6,3](0:53,.,57,.,61,.,65,...,68)
	cd_u1[0][0][31][53]=cd_u1[0][0][37][57]=cd_u1[0][0][43][61]=-1.0; cd_u1[0][0][49][65]=1.0;
	cd_u1[0][0][32][54]=cd_u1[0][0][38][58]=cd_u1[0][0][44][62]=-1.0; cd_u1[0][0][50][66]=1.0;
	cd_u1[0][0][33][55]=cd_u1[0][0][39][59]=cd_u1[0][0][45][63]=-1.0; cd_u1[0][0][51][67]=1.0;
	
	cd_u1[1][0][29][53]=cd_u1[1][0][35][57]=-1.0; cd_u1[1][0][41][61]=cd_u1[1][0][47][65]=1.0;
	cd_u1[1][0][30][54]=cd_u1[1][0][36][58]=-1.0; cd_u1[1][0][42][62]=cd_u1[1][0][48][66]=1.0;
	cd_u1[1][0][33][56]=cd_u1[1][0][39][60]=1.0; cd_u1[1][0][45][64]=cd_u1[1][0][51][68]=-1.0;
	
	cd_u1[0][1][28][53]=-1.0; cd_u1[0][1][34][57]=cd_u1[0][1][40][61]=cd_u1[0][1][46][65]=1.0;
	cd_u1[0][1][30][55]=1.0; cd_u1[0][1][36][59]=cd_u1[0][1][42][63]=cd_u1[0][1][48][67]=-1.0;
	cd_u1[0][1][32][56]=1.0; cd_u1[0][1][38][60]=cd_u1[0][1][44][64]=cd_u1[0][1][50][68]=-1.0;
	
	cd_u1[1][1][28][54]=cd_u1[1][1][34][58]=cd_u1[1][1][40][62]=cd_u1[1][1][46][66]=-1.0;
	cd_u1[1][1][29][55]=cd_u1[1][1][35][59]=cd_u1[1][1][41][63]=cd_u1[1][1][47][67]=-1.0;
	cd_u1[1][1][31][56]=cd_u1[1][1][37][60]=cd_u1[1][1][43][64]=cd_u1[1][1][49][68]=-1.0;
	// u [5,3](d1:28,.,34,.,40,.,46,...,51) [6,3](0:53,.,57,.,61,.,65,...,68)
	cu_d1[0][0][31][53]=cu_d1[0][0][37][54]=cu_d1[0][0][43][55]=cu_d1[0][0][49][56]=1.0;
	cu_d1[0][0][32][57]=cu_d1[0][0][38][58]=cu_d1[0][0][44][59]=cu_d1[0][0][50][60]=1.0;
	cu_d1[0][0][33][61]=cu_d1[0][0][39][62]=cu_d1[0][0][45][63]=cu_d1[0][0][51][64]=1.0;
	
	cu_d1[1][0][29][53]=cu_d1[1][0][35][54]=cu_d1[1][0][41][55]=1.0; cu_d1[1][0][47][56]=-1.0;
	cu_d1[1][0][30][57]=cu_d1[1][0][36][58]=cu_d1[1][0][42][59]=1.0; cu_d1[1][0][48][60]=-1.0;
	cu_d1[1][0][33][65]=cu_d1[1][0][39][66]=cu_d1[1][0][45][67]=-1.0; cu_d1[1][0][51][68]=1.0;
	
	cu_d1[0][1][28][53]=cu_d1[0][1][34][54]=1.0; cu_d1[0][1][40][55]=cu_d1[0][1][46][56]=-1.0;
	cu_d1[0][1][30][61]=cu_d1[0][1][36][62]=-1.0; cu_d1[0][1][42][63]=cu_d1[0][1][48][64]=1.0;
	cu_d1[0][1][32][65]=cu_d1[0][1][38][66]=-1.0; cu_d1[0][1][44][67]=cu_d1[0][1][50][68]=1.0;
	
	cu_d1[1][1][28][57]=-1.0; cu_d1[1][1][34][58]=cu_d1[1][1][40][59]=cu_d1[1][1][46][60]=1.0;
	cu_d1[1][1][29][61]=-1.0; cu_d1[1][1][35][62]=cu_d1[1][1][41][63]=cu_d1[1][1][47][64]=1.0;
	cu_d1[1][1][31][65]=-1.0; cu_d1[1][1][37][66]=cu_d1[1][1][43][67]=cu_d1[1][1][49][68]=1.0;
	// u [6,3](0:53,.,57,.,61,.,65,...,68) [7,3](u1:52,...,55)
	cu_0[0][0][65][52]=cu_0[0][0][66][53]=cu_0[0][0][67][54]=cu_0[0][0][68][55]=1.0;
	cu_0[1][0][61][52]=cu_0[1][0][62][53]=cu_0[1][0][63][54]=1.0; cu_0[1][0][64][55]=-1.0;
	cu_0[0][1][57][52]=cu_0[0][1][58][53]=1.0; cu_0[0][1][59][54]=cu_0[0][1][60][55]=-1.0;
	cu_0[1][1][53][52]=1.0; cu_0[1][1][54][53]=cu_0[1][1][55][54]=cu_0[1][1][56][55]=-1.0;
	// d [6,3](0:53,.,57,.,61,.,65,...,68) [7,4](d1:52,...,55)
	cd_0[0][0][56][52]=cd_0[0][0][60][53]=cd_0[0][0][64][54]=-1.0; cd_0[0][0][68][55]=1.0;
	cd_0[1][0][55][52]=cd_0[1][0][59][53]=-1.0; cd_0[1][0][63][54]=cd_0[1][0][67][55]=1.0;
	cd_0[0][1][54][52]=-1.0; cd_0[0][1][58][53]=cd_0[0][1][62][54]=cd_0[0][1][66][55]=1.0;
	cd_0[1][1][53][52]=cd_0[1][1][57][53]=cd_0[1][1][61][54]=cd_0[1][1][65][55]=1.0;
	// d [7,3](u1:52,...,55) [8,4](0:69)
	cd_u1[0][0][55][69]=cd_u1[1][0][54][69]=cd_u1[0][1][53][69]=cd_u1[1][1][52][69]=-1.0;
	// u [7,3](d1:52,...,55) [8,4](0:69)
	cu_d1[0][0][55][69]=cu_d1[1][0][54][69]=cu_d1[0][1][53][69]=cu_d1[1][1][52][69]=1.0;
	// 元の系のパラメーター double e,t,tn,U,mu,h; double ee,tt,ttn,F,AF,Px,Py;
	e=0.0; t=1.0; h=0.0;
	cout << "tn="; cin >> tn;
	cout << "U="; cin >> U;
	cout << "mu="; cin >> mu;  //mu=U/2.0;
	// 代理系のパラメーター
	ee=0.0; tt=1.0; ttn=0.0; F=0.0; Px=0.0; Py=0.0;
	// AF のループ、始まり
	for(n_AF=0;n_AF<=12;++n_AF){
		AF=0.1*n_AF;
		if(fabs(AF)<0.0000001) AF=0.0;
	cout<<"-----(AF="<<AF<<")-------\n";
	
	// 元の系のグリーン関数の初期化
	for(i=0;i<=3;++i){
		for(j=0;j<=3;++j){
			GIu[i][j]=GId[i][j]=0.0;
		};
	};
	// 代理系のハミルトニアンの初期化
	for(i=0;i<=69;++i){
		for(j=0;j<=69;++j){
			H0[i][j]=0.0;
		};
	};
	for(i=0;i<=55;++i){
		for(j=0;j<=55;++j){
			Hu1[i][j]=Hd1[i][j]=0.0;
		};
	};
	// 熱力学ポテンシャルなどの初期化
	Omega_t[n_AF]=0.0; Omega_r=Sr=Sg=0.0;
	Sur=Sdr=Sug=Sdg=0.0; Nur=Ndr=Nug=Ndg=0;
	// 代理系のハミルトニアンの対角成分
	// [0,0] 1 (0:0)
	H0[0][0]=0.0;
	// [2,1] 16 (0:1,.,5,.,9,.,13,...,16)
	H0[1][1]=H0[6][6]=H0[11][11]=H0[16][16]=(2*ee-2*mu)+U;
	H0[2][2]=H0[3][3]=H0[14][14]=H0[15][15]=(2*ee-2*mu)-2*AF;
	H0[4][4]=H0[7][7]=H0[10][10]=H0[13][13]=(2*ee-2*mu);
	H0[5][5]=H0[8][8]=H0[9][9]=H0[12][12]=(2*ee-2*mu)+2*AF;
	// [4,2] 36 (0:17,.,23,.,29,.,35,.,41,.,47,...,52)
	H0[17][17]=H0[24][24]=H0[31][31]=H0[38][38]=H0[45][45]=H0[52][52]=(4*ee-4*mu)+2*U;
	H0[18][18]=H0[21][21]=H0[23][23]=H0[28][28]=H0[41][41]=H0[46][46]=H0[48][48]=H0[51][51]=(4*ee-4*mu)+U;
	H0[19][19]=H0[25][25]=H0[35][35]=H0[36][36]=H0[39][39]=H0[40][40]=H0[43][43]=H0[49][49]=(4*ee-4*mu)+U+2*AF;
	H0[20][20]=H0[26][26]=H0[29][29]=H0[30][30]=H0[33][33]=H0[34][34]=H0[44][44]=H0[50][50]=(4*ee-4*mu)+U-2*AF;
	H0[22][22]=H0[27][27]=H0[32][32]=H0[37][37]=H0[42][42]=H0[47][47]=4*ee-4*mu;
	// [6,3] 16 (0:53,.,57,.,61,.,65,...,68)
	H0[53][53]=H0[58][58]=H0[63][63]=H0[68][68]=(6*ee-6*mu)+3*U;
	H0[54][54]=H0[55][55]=H0[66][66]=H0[67][67]=(6*ee-6*mu)+2*U+2*AF;
	H0[56][56]=H0[59][59]=H0[62][62]=H0[65][65]=(6*ee-6*mu)+2*U;
	H0[57][57]=H0[60][60]=H0[61][61]=H0[64][64]=(6*ee-6*mu)+2*U-2*AF;
	// [8,4] 1 (0:69)
	H0[69][69]=(8*ee-8*mu)+4*U;
	// [1,0] 4 (u1:0,...,3)
	Hu1[0][0]=Hu1[3][3]=(ee-F-mu)-AF;
	Hu1[1][1]=Hu1[2][2]=(ee-F-mu)+AF;
	// [3,1] 24 (u1:4,.,8,.,12,.,16,.,20,.,24,...,27)
	Hu1[4][4]=Hu1[8][8]=Hu1[17][17]=Hu1[18][18]=Hu1[23][23]=Hu1[27][27]=(3*ee-F-3*mu)+U+AF;
	Hu1[5][5]=Hu1[10][10]=Hu1[12][12]=Hu1[15][15]=Hu1[21][21]=Hu1[26][26]=(3*ee-F-3*mu)+U-AF;
	Hu1[6][6]=Hu1[9][9]=Hu1[22][22]=Hu1[25][25]=(3*ee-F-3*mu)-AF;
	Hu1[7][7]=Hu1[11][11]=Hu1[20][20]=Hu1[24][24]=(3*ee-F-3*mu)+AF;
	Hu1[13][13]=Hu1[14][14]=(3*ee-F-3*mu)-3*AF;
	Hu1[16][16]=Hu1[19][19]=(3*ee-F-3*mu)+3*AF;
	// [5,2] 24 (u1:28,.,34,.,40,.,46,.,51)
	Hu1[28][28]=Hu1[29][29]=Hu1[36][36]=Hu1[42][42]=Hu1[50][50]=Hu1[51][51]=(5*ee-F-5*mu)+2*U+AF;
	Hu1[30][30]=Hu1[48][48]=(5*ee-F-5*mu)+U+3*AF;
	Hu1[31][31]=Hu1[34][34]=Hu1[38][38]=Hu1[41][41]=Hu1[45][45]=Hu1[49][49]=(5*ee-F-5*mu)+2*U-AF;
	Hu1[32][32]=Hu1[33][33]=Hu1[46][46]=Hu1[47][47]=(5*ee-F-5*mu)+U+AF;
	Hu1[35][35]=Hu1[39][39]=Hu1[40][40]=Hu1[44][44]=(5*ee-F-5*mu)+U-AF;
	Hu1[37][37]=Hu1[43][43]=(5*ee-F-5*mu)+U-3*AF;
	// [7,3] 4 (u1:52,...55)
	Hu1[52][52]=Hu1[55][55]=(7*ee-F-7*mu)+3*U-AF;
	Hu1[53][53]=Hu1[54][54]=(7*ee-F-7*mu)+3*U+AF;
	// [1,1] 4 (d1:0,...,3)
	Hd1[0][0]=Hd1[3][3]=(ee+F-mu)+AF;
	Hd1[1][1]=Hd1[2][2]=(ee+F-mu)-AF;
	// [3,2] 24 (d1:4,.,8,.,12,.,16,.,20,.,24,...,27)
	Hd1[4][4]=Hd1[8][8]=Hd1[17][17]=Hd1[18][18]=Hd1[23][23]=Hd1[27][27]=(3*ee+F-3*mu)+U-AF;
	Hd1[5][5]=Hd1[10][10]=Hd1[12][12]=Hd1[15][15]=Hd1[21][21]=Hd1[26][26]=(3*ee+F-3*mu)+U+AF;
	Hd1[6][6]=Hd1[9][9]=Hd1[22][22]=Hd1[25][25]=(3*ee+F-3*mu)+AF;
	Hd1[7][7]=Hd1[11][11]=Hd1[20][20]=Hd1[24][24]=(3*ee+F-3*mu)-AF;
	Hd1[13][13]=Hd1[14][14]=(3*ee+F-3*mu)+3*AF;
	Hd1[16][16]=Hd1[19][19]=(3*ee+F-3*mu)-3*AF;
	// [5,3] 24 (d1:28,.,34,.,40,.,46,.,51)
	Hd1[28][28]=Hd1[29][29]=Hd1[36][36]=Hd1[42][42]=Hd1[50][50]=Hd1[51][51]=(5*ee+F-5*mu)+2*U-AF;
	Hd1[30][30]=Hd1[48][48]=(5*ee+F-5*mu)+U-3*AF;
	Hd1[31][31]=Hd1[34][34]=Hd1[38][38]=Hd1[41][41]=Hd1[45][45]=Hd1[49][49]=(5*ee+F-5*mu)+2*U+AF;
	Hd1[32][32]=Hd1[33][33]=Hd1[46][46]=Hd1[47][47]=(5*ee+F-5*mu)+U-AF;
	Hd1[35][35]=Hd1[39][39]=Hd1[40][40]=Hd1[44][44]=(5*ee+F-5*mu)+U+AF;
	Hd1[37][37]=Hd1[43][43]=(5*ee+F-5*mu)+U+3*AF;
	// [7,4] 4 (d1:52,...55)
	Hd1[52][52]=Hd1[55][55]=(7*ee+F-7*mu)+3*U+AF;
	Hd1[53][53]=Hd1[54][54]=(7*ee+F-7*mu)+3*U-AF;
	// 代理系のハミルトニアンのホッピング
	// [1,0](u1:0,...,3)
	Hu1[0][1]=Hu1[1][0]=Hu1[0][2]=Hu1[2][0]=Hu1[1][3]=Hu1[3][1]=Hu1[2][3]=Hu1[3][2]=-tt;
	Hu1[0][3]=Hu1[3][0]=Hu1[1][2]=Hu1[2][1]=-ttn;
	// [1,1](d1:0,...,3)
	Hd1[0][1]=Hd1[1][0]=Hd1[0][2]=Hd1[2][0]=Hd1[1][3]=Hd1[3][1]=Hd1[2][3]=Hd1[3][2]=-tt;
	Hd1[0][3]=Hd1[3][0]=Hd1[1][2]=Hd1[2][1]=-ttn;
	// [2,1](0:1,.,5,.,9,.,13,...,16)
	H0[1][2]=H0[2][1]=-tt;     H0[1][3]=H0[3][1]=-tt;     H0[2][4]=H0[4][2]=-tt;    H0[3][4]=H0[4][3]=-tt;
	H0[5][6]=H0[6][5]=tt;      H0[5][7]=H0[7][5]=tt;      H0[6][8]=H0[8][6]=-tt;    H0[7][8]=H0[8][7]=-tt;
	H0[9][10]=H0[10][9]=-tt;   H0[9][11]=H0[11][9]=tt;    H0[10][12]=H0[12][10]=tt; H0[11][12]=H0[12][11]=-tt;
	H0[13][14]=H0[14][13]=-tt; H0[13][15]=H0[15][13]=-tt; H0[14][16]=H0[16][14]=tt; H0[15][16]=H0[16][15]=tt;
	
	H0[1][4]=H0[4][1]=-ttn;    H0[2][3]=H0[3][2]=-ttn;
	H0[5][8]=H0[8][5]=ttn;     H0[6][7]=H0[7][6]=-ttn;
	H0[9][12]=H0[12][9]=ttn;   H0[10][11]=H0[11][10]=ttn;
	H0[13][16]=H0[16][13]=ttn; H0[14][15]=H0[15][14]=-ttn;
	
	H0[1][5]=H0[5][1]=tt;  H0[1][9]=H0[9][1]=tt;    H0[5][13]=H0[13][5]=-tt; H0[9][13]=H0[13][9]=-tt;
	H0[2][6]=H0[6][2]=-tt; H0[2][10]=H0[10][2]=tt;  H0[6][14]=H0[14][6]=tt;  H0[10][14]=H0[14][10]=-tt;
	H0[3][7]=H0[7][3]=-tt; H0[3][11]=H0[11][3]=-tt; H0[7][15]=H0[15][7]=tt;  H0[11][15]=H0[15][11]=tt;
	H0[4][8]=H0[8][4]=-tt; H0[4][12]=H0[12][4]=-tt; H0[8][16]=H0[16][8]=-tt; H0[12][16]=H0[16][12]=-tt;
	
	H0[1][13]=H0[13][1]=ttn;  H0[5][9]=H0[9][5]=-ttn;
	H0[2][14]=H0[14][2]=ttn;  H0[6][10]=H0[10][6]=ttn;
	H0[3][15]=H0[15][3]=ttn;  H0[7][11]=H0[11][7]=-ttn;
	H0[4][16]=H0[16][4]=-ttn; H0[8][12]=H0[12][8]=-ttn;
	// [3,1](u1:4,.,8,.,12,.,16,.,20,.,24,...,27)
	Hu1[4][5]=Hu1[5][4]=tt;      Hu1[4][6]=Hu1[6][4]=tt;      Hu1[5][7]=Hu1[7][5]=-tt;     Hu1[6][7]=Hu1[7][6]=-tt;
	Hu1[8][9]=Hu1[9][8]=-tt;     Hu1[8][10]=Hu1[10][8]=tt;    Hu1[9][11]=Hu1[11][9]=tt;    Hu1[10][11]=Hu1[11][10]=-tt;
	Hu1[12][13]=Hu1[13][12]=-tt; Hu1[12][14]=Hu1[14][12]=-tt; Hu1[13][15]=Hu1[15][13]=tt;  Hu1[14][15]=Hu1[15][14]=tt;
	Hu1[16][17]=Hu1[17][16]=tt;  Hu1[16][18]=Hu1[18][16]=-tt; Hu1[17][19]=Hu1[19][17]=tt;  Hu1[18][19]=Hu1[19][18]=-tt;
	Hu1[20][21]=Hu1[21][20]=tt;  Hu1[20][22]=Hu1[22][20]=tt;  Hu1[21][23]=Hu1[23][21]=tt;  Hu1[22][23]=Hu1[23][22]=tt;
	Hu1[24][25]=Hu1[25][24]=-tt; Hu1[24][26]=Hu1[26][24]=tt;  Hu1[25][27]=Hu1[27][25]=-tt; Hu1[26][27]=Hu1[27][26]=tt;
	
	Hu1[4][7]  =Hu1[7][4]  =ttn;  Hu1[5][6]  =Hu1[6][5]  =-ttn;
	Hu1[8][11] =Hu1[11][8] =ttn;  Hu1[9][10] =Hu1[10][9] =ttn;
	Hu1[12][15]=Hu1[15][12]=ttn;  Hu1[13][14]=Hu1[14][13]=-ttn;
	Hu1[16][19]=Hu1[19][16]=-ttn; Hu1[17][18]=Hu1[18][17]=ttn;
	Hu1[20][23]=Hu1[23][20]=-ttn; Hu1[21][22]=Hu1[22][21]=-ttn;
	Hu1[24][27]=Hu1[27][24]=-ttn; Hu1[25][26]=Hu1[26][25]=ttn;
	
	Hu1[4][12]=Hu1[12][4]=-tt;   Hu1[4][16]=Hu1[16][4]=-tt;   Hu1[8][12]=Hu1[12][8]=-tt;   Hu1[8][16]=Hu1[16][8]=tt;
	Hu1[12][20]=Hu1[20][12]=tt;  Hu1[12][24]=Hu1[24][12]=tt;  Hu1[16][20]=Hu1[20][16]=-tt; Hu1[16][24]=Hu1[24][16]=tt;
	
	Hu1[5][13]=Hu1[13][5]=tt;    Hu1[5][17]=Hu1[17][5]=-tt;   Hu1[9][13]=Hu1[13][9]=-tt;   Hu1[9][17]=Hu1[17][9]=-tt;
	Hu1[13][21]=Hu1[21][13]=-tt; Hu1[13][25]=Hu1[25][13]=tt;  Hu1[17][21]=Hu1[21][17]=-tt; Hu1[17][25]=Hu1[25][17]=-tt;
	
	Hu1[6][14]=Hu1[14][6]=tt;    Hu1[6][18]=Hu1[18][6]=tt;    Hu1[10][14]=Hu1[14][10]=tt;  Hu1[10][18]=Hu1[18][10]=-tt;
	Hu1[14][22]=Hu1[22][14]=-tt; Hu1[14][26]=Hu1[26][14]=-tt; Hu1[18][22]=Hu1[22][18]=tt;  Hu1[18][26]=Hu1[26][18]=-tt;
	
	Hu1[7][15]=Hu1[15][7]=-tt;   Hu1[7][19]=Hu1[19][7]=tt;    Hu1[11][15]=Hu1[15][11]=-tt; Hu1[11][19]=Hu1[19][11]=-tt;
	Hu1[15][23]=Hu1[23][15]=-tt; Hu1[15][27]=Hu1[27][15]=-tt; Hu1[19][23]=Hu1[23][19]=-tt; Hu1[19][27]=Hu1[27][19]=tt;
	
	Hu1[4][8]=Hu1[8][4]=-ttn;    Hu1[4][20]=Hu1[20][4]=-ttn; Hu1[8][24]=Hu1[24][8]=-ttn;    Hu1[20][24]=Hu1[24][20]=-ttn;
	Hu1[5][9]=Hu1[9][5]=ttn;     Hu1[5][21]=Hu1[21][5]=-ttn; Hu1[9][25]=Hu1[25][9]=-ttn;    Hu1[21][25]=Hu1[25][21]=ttn;
	Hu1[6][10]=Hu1[10][6]=-ttn;  Hu1[6][22]=Hu1[22][6]=-ttn; Hu1[10][26]=Hu1[26][10]=-ttn;  Hu1[22][26]=Hu1[26][22]=-ttn;
	Hu1[7][11]=Hu1[11][7]=-ttn;  Hu1[7][23]=Hu1[23][7]=ttn;  Hu1[11][27]=Hu1[27][11]=ttn;   Hu1[23][27]=Hu1[27][23]=-ttn;
	// [3,2](d1:4,.,8,.,12,.,16,.,20,.,24,...,27)
	Hd1[4][5]=Hd1[5][4]=tt;      Hd1[4][6]=Hd1[6][4]=-tt;     Hd1[5][7]=Hd1[7][5]=tt;      Hd1[6][7]=Hd1[7][6]=-tt;
	Hd1[8][9]=Hd1[9][8]=tt;      Hd1[8][10]=Hd1[10][8]=tt;    Hd1[9][11]=Hd1[11][9]=tt;    Hd1[10][11]=Hd1[11][10]=tt;
	Hd1[12][13]=Hd1[13][12]=tt;  Hd1[12][14]=Hd1[14][12]=tt;  Hd1[13][15]=Hd1[15][13]=-tt; Hd1[14][15]=Hd1[15][14]=-tt;
	Hd1[16][17]=Hd1[17][16]=-tt; Hd1[16][18]=Hd1[18][16]=tt;  Hd1[17][19]=Hd1[19][17]=-tt; Hd1[18][19]=Hd1[19][18]=tt;
	Hd1[20][21]=Hd1[21][20]=-tt; Hd1[20][22]=Hd1[22][20]=tt;  Hd1[21][23]=Hd1[23][21]=tt;  Hd1[22][23]=Hd1[23][22]=-tt;
	Hd1[24][25]=Hd1[25][24]=-tt; Hd1[24][26]=Hd1[26][24]=-tt; Hd1[25][27]=Hd1[27][25]=tt;  Hd1[26][27]=Hd1[27][26]=tt;
	
	Hd1[4][7]=Hd1[7][4]=-ttn;     Hd1[5][6]=Hd1[6][5]=ttn;
	Hd1[8][11]=Hd1[11][8]=-ttn;   Hd1[9][10]=Hd1[10][9]=-ttn;
	Hd1[12][15]=Hd1[15][12]=ttn;  Hd1[13][14]=Hd1[14][13]=-ttn;
	Hd1[16][19]=Hd1[19][16]=-ttn; Hd1[17][18]=Hd1[18][17]=ttn;
	Hd1[20][23]=Hd1[23][20]=ttn;  Hd1[21][22]=Hd1[22][21]=ttn;
	Hd1[24][27]=Hd1[27][24]=ttn;  Hd1[25][26]=Hd1[26][25]=-ttn;
	
	Hd1[4][12]=Hd1[12][4]=-tt;   Hd1[4][16]=Hd1[16][4]=tt;    Hd1[8][12]=Hd1[12][8]=-tt;   Hd1[8][16]=Hd1[16][8]=-tt;
	Hd1[12][20]=Hd1[20][12]=-tt; Hd1[12][24]=Hd1[24][12]=-tt; Hd1[16][20]=Hd1[20][16]=-tt; Hd1[16][24]=Hd1[24][16]=tt;
	
	Hd1[5][13]=Hd1[13][5]=-tt;   Hd1[5][17]=Hd1[17][5]=-tt;   Hd1[9][13]=Hd1[13][9]=-tt;   Hd1[9][17]=Hd1[17][9]=tt;
	Hd1[13][21]=Hd1[21][13]=tt;  Hd1[13][25]=Hd1[25][13]=tt;  Hd1[17][21]=Hd1[21][17]=-tt; Hd1[17][25]=Hd1[25][17]=tt;
	
	Hd1[6][14]=Hd1[14][6]=tt;    Hd1[6][18]=Hd1[18][6]=-tt;   Hd1[10][14]=Hd1[14][10]=-tt; Hd1[10][18]=Hd1[18][10]=-tt;
	Hd1[14][22]=Hd1[22][14]=-tt; Hd1[14][26]=Hd1[26][14]=tt;  Hd1[18][22]=Hd1[22][18]=-tt; Hd1[18][26]=Hd1[26][18]=-tt;
	
	Hd1[7][15]=Hd1[15][7]=tt;    Hd1[7][19]=Hd1[19][7]=tt;    Hd1[11][15]=Hd1[15][11]=tt;  Hd1[11][19]=Hd1[19][11]=-tt;
	Hd1[15][23]=Hd1[23][15]=-tt; Hd1[15][27]=Hd1[27][15]=-tt; Hd1[19][23]=Hd1[23][19]=tt;  Hd1[19][27]=Hd1[27][19]=-tt;
	
	Hd1[4][8]=Hd1[8][4]=-ttn;    Hd1[4][20]=Hd1[20][4]=ttn; Hd1[8][24]=Hd1[24][8]=ttn;    Hd1[20][24]=Hd1[24][20]=-ttn;
	Hd1[5][9]=Hd1[9][5]=-ttn;    Hd1[5][21]=Hd1[21][5]=-ttn; Hd1[9][25]=Hd1[25][9]=-ttn;    Hd1[21][25]=Hd1[25][21]=-ttn;
	Hd1[6][10]=Hd1[10][6]=ttn;    Hd1[6][22]=Hd1[22][6]=-ttn; Hd1[10][26]=Hd1[26][10]=-ttn;    Hd1[22][26]=Hd1[26][22]=ttn;
	Hd1[7][11]=Hd1[11][7]=-ttn;    Hd1[7][23]=Hd1[23][7]=-ttn; Hd1[11][27]=Hd1[27][11]=-ttn;    Hd1[23][27]=Hd1[27][23]=-ttn;
	// [4,2](0:17,.,23,.,29,.,35,.,41,.,47,...,52)
	H0[17][19]=H0[19][17]=-tt; H0[17][20]=H0[20][17]=-tt; H0[18][19]=H0[19][18]=-tt; H0[18][20]=H0[20][18]=tt;
	H0[19][21]=H0[21][19]=tt;  H0[19][22]=H0[22][19]=tt;  H0[20][21]=H0[21][20]=-tt; H0[20][22]=H0[22][20]=tt;
	
	H0[23][25]=H0[25][23]=tt;  H0[23][26]=H0[26][23]=-tt; H0[24][25]=H0[25][24]=-tt; H0[24][26]=H0[26][24]=-tt;
	H0[25][27]=H0[27][25]=-tt; H0[25][28]=H0[28][25]=tt;  H0[26][27]=H0[27][26]=-tt; H0[26][28]=H0[28][26]=-tt;
	
	H0[29][31]=H0[31][29]=tt;  H0[29][32]=H0[32][29]=tt;  H0[30][31]=H0[31][30]=tt; H0[30][32]=H0[32][30]=-tt;
	H0[31][33]=H0[33][31]=-tt; H0[31][34]=H0[34][31]=-tt; H0[32][33]=H0[33][32]=tt; H0[32][34]=H0[34][32]=-tt;
	
	H0[35][37]=H0[37][35]=tt; H0[35][38]=H0[38][35]=tt;  H0[36][37]=H0[37][36]=-tt; H0[36][38]=H0[38][36]=tt;
	H0[37][39]=H0[39][37]=tt; H0[37][40]=H0[40][37]=-tt; H0[38][39]=H0[39][38]=-tt; H0[38][40]=H0[40][38]=-tt;
	
	H0[41][43]=H0[43][41]=tt; H0[41][44]=H0[44][41]=-tt; H0[42][43]=H0[43][42]=tt; H0[42][44]=H0[44][42]=tt;
	H0[43][45]=H0[45][43]=tt; H0[43][46]=H0[46][43]=tt;  H0[44][45]=H0[45][44]=tt; H0[44][46]=H0[46][44]=-tt;
	
	H0[47][49]=H0[49][47]=-tt; H0[47][50]=H0[50][47]=-tt; H0[48][49]=H0[49][48]=tt; H0[48][50]=H0[50][48]=-tt;
	H0[49][51]=H0[51][49]=-tt; H0[49][52]=H0[52][49]=tt;  H0[50][51]=H0[51][50]=tt; H0[50][52]=H0[52][50]=tt;
	
	H0[17][18]=H0[18][17]=-ttn; H0[17][21]=H0[21][17]=-ttn; H0[18][22]=H0[22][18]=-ttn; H0[21][22]=H0[22][21]=-ttn;
	H0[23][24]=H0[24][23]=ttn;  H0[23][27]=H0[27][23]=-ttn; H0[24][28]=H0[28][24]=-ttn; H0[27][28]=H0[28][27]=ttn;
	H0[29][30]=H0[30][29]=-ttn; H0[29][33]=H0[33][29]=-ttn; H0[30][34]=H0[34][30]=-ttn; H0[33][34]=H0[34][33]=-ttn;
	H0[35][36]=H0[36][35]=ttn;  H0[35][39]=H0[39][35]=ttn;  H0[36][40]=H0[40][36]=ttn;  H0[39][40]=H0[40][39]=ttn;
	H0[41][42]=H0[42][41]=-ttn; H0[41][45]=H0[45][41]=ttn;  H0[42][46]=H0[46][42]=ttn;  H0[45][46]=H0[46][45]=ttn;
	H0[47][48]=H0[48][47]=ttn;  H0[47][51]=H0[51][47]=ttn;  H0[48][52]=H0[52][48]=ttn;  H0[51][52]=H0[52][51]=-ttn;
	
	H0[17][29]=H0[29][17]=tt; H0[17][35]=H0[35][17]=tt;  H0[23][29]=H0[29][23]=-tt; H0[23][35]=H0[35][23]=tt;
	H0[29][41]=H0[41][29]=tt; H0[29][47]=H0[47][29]=-tt; H0[35][41]=H0[41][35]=-tt; H0[35][47]=H0[47][35]=-tt;
	
	H0[18][30]=H0[30][18]=tt; H0[18][36]=H0[36][18]=-tt; H0[24][30]=H0[30][24]=tt; H0[24][36]=H0[36][24]=tt;
	H0[30][42]=H0[42][30]=tt; H0[30][48]=H0[48][30]=tt;  H0[36][42]=H0[42][36]=tt; H0[36][48]=H0[48][36]=-tt;
	
	H0[19][31]=H0[31][19]=-tt; H0[19][37]=H0[37][19]=-tt; H0[25][31]=H0[31][25]=-tt; H0[25][37]=H0[37][25]=tt;
	H0[31][43]=H0[43][31]=tt;  H0[31][49]=H0[49][31]=tt;  H0[37][43]=H0[43][37]=-tt; H0[37][49]=H0[49][37]=tt;
	
	H0[20][32]=H0[32][20]=-tt; H0[20][38]=H0[38][20]=-tt; H0[26][32]=H0[32][26]=tt; H0[26][38]=H0[38][26]=-tt;
	H0[32][44]=H0[44][32]=-tt; H0[32][50]=H0[50][32]=tt;  H0[38][44]=H0[44][38]=tt; H0[38][50]=H0[50][38]=tt;
	
	H0[21][33]=H0[33][21]=tt;  H0[21][39]=H0[39][21]=-tt; H0[27][33]=H0[33][27]=-tt; H0[27][39]=H0[39][27]=-tt;
	H0[33][45]=H0[45][33]=-tt; H0[33][51]=H0[51][33]=tt;  H0[39][45]=H0[45][39]=-tt; H0[39][51]=H0[51][39]=-tt;
	
	H0[22][34]=H0[34][22]=tt;  H0[22][40]=H0[40][22]=tt;  H0[28][34]=H0[34][28]=tt; H0[28][40]=H0[40][28]=-tt;
	H0[34][46]=H0[46][34]=-tt; H0[34][52]=H0[52][34]=-tt; H0[40][46]=H0[46][40]=tt; H0[40][52]=H0[52][40]=-tt;
	
	H0[17][23]=H0[23][17]=ttn;  H0[17][41]=H0[41][17]=ttn;  H0[23][47]=H0[47][23]=ttn;  H0[41][47]=H0[47][41]=ttn;
	H0[18][24]=H0[24][18]=-ttn; H0[18][42]=H0[42][18]=ttn;  H0[24][48]=H0[48][24]=ttn;  H0[42][48]=H0[48][42]=-ttn;
	H0[19][25]=H0[25][19]=-ttn; H0[19][43]=H0[43][19]=-ttn; H0[25][49]=H0[49][25]=-ttn; H0[43][49]=H0[49][43]=-ttn;
	H0[20][26]=H0[26][20]=ttn;  H0[20][44]=H0[44][20]=ttn;  H0[26][50]=H0[50][26]=ttn;  H0[44][50]=H0[50][44]=ttn;
	H0[21][27]=H0[27][21]=ttn;  H0[21][45]=H0[45][21]=-ttn; H0[27][51]=H0[51][27]=-ttn; H0[45][51]=H0[51][45]=ttn;
	H0[22][28]=H0[28][22]=-ttn; H0[22][46]=H0[46][22]=-ttn; H0[28][52]=H0[52][28]=-ttn; H0[46][52]=H0[52][46]=-ttn;
	// [5,2](u1:28,.,34,.,40,.,46,...,51)
	Hu1[28][30]=Hu1[30][28]=tt;  Hu1[28][31]=Hu1[31][28]=tt;  Hu1[29][30]=Hu1[30][29]=-tt; Hu1[29][31]=Hu1[31][29]=tt;
	Hu1[30][32]=Hu1[32][30]=tt;  Hu1[30][33]=Hu1[33][30]=-tt; Hu1[31][32]=Hu1[32][31]=-tt; Hu1[31][33]=Hu1[33][31]=-tt;
	Hu1[28][29]=Hu1[29][28]=ttn; Hu1[28][32]=Hu1[32][28]=ttn; Hu1[29][33]=Hu1[33][29]=ttn; Hu1[32][33]=Hu1[33][32]=ttn;
	
	Hu1[34][36]=Hu1[36][34]=tt;   Hu1[34][37]=Hu1[37][34]=-tt; Hu1[35][36]=Hu1[36][35]=tt;  Hu1[35][37]=Hu1[37][35]=tt;
	Hu1[36][38]=Hu1[38][36]=tt;   Hu1[36][39]=Hu1[39][36]=tt;  Hu1[37][38]=Hu1[38][37]=tt;  Hu1[37][39]=Hu1[39][37]=-tt;
	Hu1[34][35]=Hu1[35][34]=-ttn; Hu1[34][38]=Hu1[38][34]=ttn; Hu1[35][39]=Hu1[39][35]=ttn; Hu1[38][39]=Hu1[39][38]=-ttn;
	
	Hu1[40][42]=Hu1[42][40]=-tt; Hu1[40][43]=Hu1[43][40]=-tt; Hu1[41][42]=Hu1[42][41]=tt;  Hu1[41][43]=Hu1[43][41]=-tt;
	Hu1[42][44]=Hu1[44][42]=-tt; Hu1[42][45]=Hu1[45][42]=tt;  Hu1[43][44]=Hu1[44][43]=tt;  Hu1[43][45]=Hu1[45][43]=tt;
	Hu1[40][41]=Hu1[41][40]=ttn; Hu1[40][44]=Hu1[44][40]=ttn; Hu1[41][45]=Hu1[45][41]=ttn; Hu1[44][45]=Hu1[45][44]=ttn;
	
	Hu1[46][48]=Hu1[48][46]=-tt; Hu1[46][49]=Hu1[49][46]=tt;   Hu1[47][48]=Hu1[48][47]=tt;   Hu1[47][49]=Hu1[49][47]=tt;
	Hu1[48][50]=Hu1[50][48]=tt;  Hu1[48][51]=Hu1[51][48]=-tt;  Hu1[49][50]=Hu1[50][49]=tt;   Hu1[49][51]=Hu1[51][49]=tt;
	Hu1[46][47]=Hu1[47][46]=ttn; Hu1[46][50]=Hu1[50][46]=-ttn; Hu1[47][51]=Hu1[51][47]=-ttn; Hu1[50][51]=Hu1[51][50]=ttn;
	
	Hu1[28][34]=Hu1[34][28]=-tt; Hu1[28][40]=Hu1[40][28]=-tt; Hu1[34][46]=Hu1[46][34]=tt;  Hu1[40][46]=Hu1[46][40]=tt;
	Hu1[29][35]=Hu1[35][29]=tt;  Hu1[29][41]=Hu1[41][29]=-tt; Hu1[35][47]=Hu1[47][35]=-tt; Hu1[41][47]=Hu1[47][41]=tt;
	Hu1[30][36]=Hu1[36][30]=-tt; Hu1[30][42]=Hu1[42][30]=tt;  Hu1[36][48]=Hu1[48][36]=-tt; Hu1[42][48]=Hu1[48][42]=tt;
	Hu1[31][37]=Hu1[37][31]=tt;  Hu1[31][43]=Hu1[43][31]=tt;  Hu1[37][49]=Hu1[49][37]=-tt; Hu1[43][49]=Hu1[49][43]=-tt;
	Hu1[32][38]=Hu1[38][32]=-tt; Hu1[32][44]=Hu1[44][32]=-tt; Hu1[38][50]=Hu1[50][38]=-tt; Hu1[44][50]=Hu1[50][44]=-tt;
	Hu1[33][39]=Hu1[39][33]=tt;  Hu1[33][45]=Hu1[45][33]=-tt; Hu1[39][51]=Hu1[51][39]=tt;  Hu1[45][51]=Hu1[51][45]=-tt;
	
	Hu1[28][46]=Hu1[46][28]=-ttn; Hu1[34][40]=Hu1[40][34]=ttn;
	Hu1[29][47]=Hu1[47][29]=-ttn; Hu1[35][41]=Hu1[41][35]=-ttn;
	Hu1[30][48]=Hu1[48][30]=ttn;  Hu1[36][42]=Hu1[42][36]=-ttn;
	Hu1[31][49]=Hu1[49][31]=-ttn; Hu1[37][43]=Hu1[43][37]=ttn;
	Hu1[32][50]=Hu1[50][32]=ttn;  Hu1[38][44]=Hu1[44][38]=ttn;
	Hu1[33][51]=Hu1[51][33]=ttn;  Hu1[39][45]=Hu1[45][39]=-ttn;
	// [5,3](d1:28,.,34,.,40,.,46,...,51)
	Hd1[28][30]=Hd1[30][28]=-tt; Hd1[28][31]=Hd1[31][28]=tt;   Hd1[29][30]=Hd1[30][29]=tt;   Hd1[29][31]=Hd1[31][29]=tt;
	Hd1[30][32]=Hd1[32][30]=tt;  Hd1[30][33]=Hd1[33][30]=-tt;  Hd1[31][32]=Hd1[32][31]=tt;   Hd1[31][33]=Hd1[33][31]=tt;
	Hd1[28][29]=Hd1[29][28]=ttn; Hd1[28][32]=Hd1[32][28]=-ttn; Hd1[29][33]=Hd1[33][29]=-ttn; Hd1[32][33]=Hd1[33][32]=ttn;
	
	Hd1[34][36]=Hd1[36][34]=tt;  Hd1[34][37]=Hd1[37][34]=tt;  Hd1[35][36]=Hd1[36][35]=-tt;  Hd1[35][37]=Hd1[37][35]=tt;
	Hd1[36][38]=Hd1[38][36]=tt;  Hd1[36][39]=Hd1[39][36]=-tt; Hd1[37][38]=Hd1[38][37]=-tt;  Hd1[37][39]=Hd1[39][37]=-tt;
	Hd1[34][35]=Hd1[35][34]=ttn; Hd1[34][38]=Hd1[38][34]=ttn; Hd1[35][39]=Hd1[39][35]=ttn;  Hd1[38][39]=Hd1[39][38]=ttn;
	
	Hd1[40][42]=Hd1[42][40]=tt;   Hd1[40][43]=Hd1[43][40]=-tt; Hd1[41][42]=Hd1[42][41]=tt;  Hd1[41][43]=Hd1[43][41]=tt;
	Hd1[42][44]=Hd1[44][42]=tt;   Hd1[42][45]=Hd1[45][42]=tt;  Hd1[43][44]=Hd1[44][43]=tt;  Hd1[43][45]=Hd1[45][43]=-tt;
	Hd1[40][41]=Hd1[41][40]=-ttn; Hd1[40][44]=Hd1[44][40]=ttn; Hd1[41][45]=Hd1[45][41]=ttn; Hd1[44][45]=Hd1[45][44]=-ttn;
	
	Hd1[46][48]=Hd1[48][46]=-tt; Hd1[46][49]=Hd1[49][46]=-tt; Hd1[47][48]=Hd1[48][47]=tt;  Hd1[47][49]=Hd1[49][47]=-tt;
	Hd1[48][50]=Hd1[50][48]=-tt; Hd1[48][51]=Hd1[51][48]=tt;  Hd1[49][50]=Hd1[50][49]=tt;  Hd1[49][51]=Hd1[51][49]=tt;
	Hd1[46][47]=Hd1[47][46]=ttn; Hd1[46][50]=Hd1[50][46]=ttn; Hd1[47][51]=Hd1[51][47]=ttn; Hd1[50][51]=Hd1[51][50]=ttn;
	
	Hd1[28][34]=Hd1[34][28]=-tt; Hd1[28][40]=Hd1[40][28]=tt;  Hd1[34][46]=Hd1[46][34]=-tt; Hd1[40][46]=Hd1[46][40]=tt;
	Hd1[29][35]=Hd1[35][29]=-tt; Hd1[29][41]=Hd1[41][29]=-tt; Hd1[35][47]=Hd1[47][35]=-tt; Hd1[41][47]=Hd1[47][41]=-tt;
	Hd1[30][36]=Hd1[36][30]=tt;  Hd1[30][42]=Hd1[42][30]=-tt; Hd1[36][48]=Hd1[48][36]=tt;  Hd1[42][48]=Hd1[48][42]=-tt;
	Hd1[31][37]=Hd1[37][31]=-tt; Hd1[31][43]=Hd1[43][31]=-tt; Hd1[37][49]=Hd1[49][37]=tt;  Hd1[43][49]=Hd1[49][43]=tt;
	Hd1[32][38]=Hd1[38][32]=tt;  Hd1[32][44]=Hd1[44][32]=-tt; Hd1[38][50]=Hd1[50][38]=-tt; Hd1[44][50]=Hd1[50][44]=tt;
	Hd1[33][39]=Hd1[39][33]=tt;  Hd1[33][45]=Hd1[45][33]=tt;  Hd1[39][51]=Hd1[51][39]=-tt; Hd1[45][51]=Hd1[51][45]=-tt;
	
	Hd1[28][46]=Hd1[46][28]=ttn;  Hd1[34][40]=Hd1[40][34]=-ttn;
	Hd1[29][47]=Hd1[47][29]=ttn;  Hd1[35][41]=Hd1[41][35]=ttn;
	Hd1[30][48]=Hd1[48][30]=ttn;  Hd1[36][42]=Hd1[42][36]=-ttn;
	Hd1[31][49]=Hd1[49][31]=-ttn; Hd1[37][43]=Hd1[43][37]=ttn;
	Hd1[32][50]=Hd1[50][32]=-ttn; Hd1[38][44]=Hd1[44][38]=-ttn;
	Hd1[33][51]=Hd1[51][33]=-ttn; Hd1[39][45]=Hd1[45][39]=ttn;
	// [6,3](0:53,.,57,.,61,.,65,...,68)
	H0[53][54]=H0[54][53]=-tt; H0[53][55]=H0[55][53]=-tt; H0[54][56]=H0[56][54]=tt;  H0[55][56]=H0[56][55]=tt;
	H0[57][58]=H0[58][57]=tt;  H0[57][59]=H0[59][57]=-tt; H0[58][60]=H0[60][58]=-tt; H0[59][60]=H0[60][59]=tt;
	H0[61][62]=H0[62][61]=tt;  H0[61][63]=H0[63][61]=tt;  H0[62][64]=H0[64][62]=-tt; H0[63][64]=H0[64][63]=-tt;
	H0[65][66]=H0[66][65]=tt;  H0[65][67]=H0[67][65]=tt;  H0[66][68]=H0[68][66]=tt;  H0[67][68]=H0[68][67]=tt;
	
	H0[53][56]=H0[56][53]=-ttn; H0[54][55]=H0[55][54]=ttn;
	H0[57][60]=H0[60][57]=-ttn; H0[58][59]=H0[59][58]=-ttn;
	H0[61][64]=H0[64][61]=-ttn; H0[62][63]=H0[63][62]=ttn;
	H0[65][68]=H0[68][65]=ttn;  H0[66][67]=H0[67][66]=ttn;
	
	H0[53][57]=H0[57][53]=tt;  H0[53][61]=H0[61][53]=tt;  H0[57][65]=H0[65][57]=tt;  H0[61][65]=H0[65][61]=tt;
	H0[54][58]=H0[58][54]=-tt; H0[54][62]=H0[62][54]=-tt; H0[58][66]=H0[66][58]=tt;  H0[62][66]=H0[66][62]=tt;
	H0[55][59]=H0[59][55]=tt;  H0[55][63]=H0[63][55]=-tt; H0[59][67]=H0[67][59]=-tt; H0[63][67]=H0[67][63]=tt;
	H0[56][60]=H0[60][56]=tt;  H0[56][64]=H0[64][56]=tt;  H0[60][68]=H0[68][60]=-tt; H0[64][68]=H0[68][64]=-tt;
	
	H0[53][65]=H0[65][53]=ttn;  H0[57][61]=H0[61][57]=ttn;
	H0[54][66]=H0[66][53]=-ttn; H0[58][62]=H0[62][58]=ttn;
	H0[55][67]=H0[67][53]=-ttn; H0[59][63]=H0[63][59]=-ttn;
	H0[56][68]=H0[68][53]=-ttn; H0[60][64]=H0[64][60]=ttn;
	// [7,3](u1:52,...,55)
	Hu1[52][53]=Hu1[53][52]=tt;  Hu1[52][54]=Hu1[54][52]=tt;  Hu1[53][55]=Hu1[55][53]=tt; Hu1[54][55]=Hu1[55][54]=tt;
	Hu1[52][55]=Hu1[55][52]=ttn; Hu1[53][54]=Hu1[54][53]=ttn;
	// [7,4](d1:52,...,55)
	Hd1[52][53]=Hd1[53][52]=tt;  Hd1[52][54]=Hd1[54][52]=tt;  Hd1[53][55]=Hd1[55][53]=tt; Hd1[54][55]=Hd1[55][54]=tt;
	Hd1[52][55]=Hd1[55][52]=ttn; Hd1[53][54]=Hd1[54][53]=ttn;
	
	// 代理系のハミルトニアンの対角化
	dsyev_( jobz, uplo, 70, (double**)H0, 70, E0, work, 209, info);
	if(info!=0) cout << "info=" << info << " (H0)\n";
	dsyev_( jobz, uplo, 56, (double**)Hu1, 56, Eu1, work, 167, info);
	if(info!=0) cout << "info=" << info << " (Hu1)\n";
	dsyev_( jobz, uplo, 56, (double**)Hd1, 56, Ed1, work, 167, info);
	if(info!=0) cout << "info=" << info << " (Hd1)\n";
	if(fabs(E0[0]-E0[1])<0.0000001){
		cout << "基底状態は縮退しています\n";
	};
	cout <<"E0=("<<E0[0]<<","<<E0[1]<<","<<E0[2]<<","<<E0[3]<<","<<E0[4]<<","<<E0[5]<<","<<E0[6]<<","<<E0[7]<<",...)\n";
	/*
	cout <<"[4,2](17,..,22):H0[0][i]=("<<H0[0][17]<<","<<H0[0][18]<<","<<H0[0][19]<<","<<H0[0][20]<<","<<H0[0][21]<<","<<H0[0][22]<<")\n";
	cout <<"[4,2](23,..,28):H0[0][i]=("<<H0[0][23]<<","<<H0[0][24]<<","<<H0[0][25]<<","<<H0[0][26]<<","<<H0[0][27]<<","<<H0[0][28]<<")\n";
	cout <<"[4,2](29,..,34):H0[0][i]=("<<H0[0][29]<<","<<H0[0][30]<<","<<H0[0][31]<<","<<H0[0][32]<<","<<H0[0][33]<<","<<H0[0][34]<<")\n";
	cout <<"[4,2](35,..,40):H0[0][i]=("<<H0[0][35]<<","<<H0[0][36]<<","<<H0[0][37]<<","<<H0[0][38]<<","<<H0[0][39]<<","<<H0[0][40]<<")\n";
	cout <<"[4,2](41,..,46):H0[0][i]=("<<H0[0][41]<<","<<H0[0][42]<<","<<H0[0][43]<<","<<H0[0][44]<<","<<H0[0][45]<<","<<H0[0][46]<<")\n";
	cout <<"[4,2](47,..,52):H0[0][i]=("<<H0[0][47]<<","<<H0[0][48]<<","<<H0[0][49]<<","<<H0[0][50]<<","<<H0[0][51]<<","<<H0[0][52]<<")\n";
	*/
	if(H0[0][0]!=0.0){
		cout << "[0,0] が混ざってます。\n";
		cout << "[0,0](0):H0[0][i]=("<<H0[0][0]<<")\n";
	};
	
	if((H0[0][1]!=0.0)||(H0[0][2]!=0.0)||(H0[0][3]!=0.0)||(H0[0][4]!=0.0)||(H0[0][5]!=0.0)||(H0[0][6]!=0.0)
	||(H0[0][7]!=0.0)||(H0[0][8]!=0.0)||(H0[0][9]!=0.0)||(H0[0][10]!=0.0)||(H0[0][11]!=0.0)||(H0[0][12]!=0.0)
	||(H0[0][13]!=0.0)||(H0[0][14]!=0.0)||(H0[0][15]!=0.0)||(H0[0][16]!=0.0)){
		cout << "[2,1] が混ざってます。\n";
		cout <<"[2,1](1,..,8):H0[0][i]=("<<H0[0][1]<<","<<H0[0][2]<<","<<H0[0][3]<<","<<H0[0][4]<<","<<
		H0[0][5]<<","<<H0[0][6]<<","<<H0[0][7]<<","<<H0[0][8]<<")\n";
		cout <<"[2,1](9,..,16):H0[0][i]=("<<H0[0][9]<<","<<H0[0][10]<<","<<H0[0][11]<<","<<H0[0][12]<<","<<
		H0[0][13]<<","<<H0[0][14]<<","<<H0[0][15]<<","<<H0[0][16]<<")\n";
	};
	if((H0[0][53]!=0.0)||(H0[0][54]!=0.0)||(H0[0][55]!=0.0)||(H0[0][56]!=0.0)||(H0[0][57]!=0.0)
	||(H0[0][58]!=0.0)||(H0[0][59]!=0.0)||(H0[0][60]!=0.0)||(H0[0][61]!=0.0)||(H0[0][62]!=0.0)||(H0[0][63]!=0.0)
	||(H0[0][64]!=0.0)||(H0[0][65]!=0.0)||(H0[0][66]!=0.0)||(H0[0][67]!=0.0)||(H0[0][68]!=0.0)){
		cout << "[6,3] が混ざってます。\n";
		cout <<"[6,3](53,..,60):H0[0][i]=("<<H0[0][53]<<","<<H0[0][54]<<","<<H0[0][55]<<","<<H0[0][56]<<","<<
		H0[0][57]<<","<<H0[0][58]<<","<<H0[0][59]<<","<<H0[0][60]<<")\n";
		cout <<"[6,3](61,..,68):H0[0][i]=("<<H0[0][61]<<","<<H0[0][62]<<","<<H0[0][63]<<","<<H0[0][64]<<","<<
		H0[0][65]<<","<<H0[0][66]<<","<<H0[0][67]<<","<<H0[0][68]<<")\n";
	};
	if(H0[0][69]!=0.0){
		cout << "[8,4] が混ざってます。\n";
		cout << "[8,4](69):H0[0][i]=("<<H0[0][69]<<")\n";
	};
	if((h==0.0)&&(F==0.0)&&(AF=0.0)&&(Px==0.0)&&(Py=0.0)){
		for(i=0;i<=55;++i){
			if(fabs(Eu1[i]-Ed1[i])>0.0000000001) 
			cout<<"[i="<<i<<"] : (Eu1,Ed1)=("<<Eu1[i]<<","<<Ed1[i]<<")\n";
		};
	};
	
	// 代理系の分配関数と熱力学ポテンシャル
	Omega_r=E0[0]/4.0;
	//cout << "Omega_r=" << Omega_r <<"\n";
	// 生成消滅演算子の基底のとりかえ、代理系のグリーン関数の重み
	for(m=0;m<=55;++m){
		for(x=0;x<=1;++x){
			for(y=0;y<=1;++y){
				au[x][y]=bu[x][y]=ad[x][y]=bd[x][y]=0.0;
			};
		};
		for(i=0;i<=69;++i){
			for(j=0;j<=55;++j){
				au[0][0]+=H0[0][i]*cu_0[0][0][i][j]*Hu1[m][j]; bu[0][0]+=Hd1[m][j]*cu_d1[0][0][j][i]*H0[0][i];
				au[1][0]+=H0[0][i]*cu_0[1][0][i][j]*Hu1[m][j]; bu[1][0]+=Hd1[m][j]*cu_d1[1][0][j][i]*H0[0][i];
				au[0][1]+=H0[0][i]*cu_0[0][1][i][j]*Hu1[m][j]; bu[0][1]+=Hd1[m][j]*cu_d1[0][1][j][i]*H0[0][i];
				au[1][1]+=H0[0][i]*cu_0[1][1][i][j]*Hu1[m][j]; bu[1][1]+=Hd1[m][j]*cu_d1[1][1][j][i]*H0[0][i];
				
				ad[0][0]+=H0[0][i]*cd_0[0][0][i][j]*Hd1[m][j]; bd[0][0]+=Hu1[m][j]*cd_u1[0][0][j][i]*H0[0][i];
				ad[1][0]+=H0[0][i]*cd_0[1][0][i][j]*Hd1[m][j]; bd[1][0]+=Hu1[m][j]*cd_u1[1][0][j][i]*H0[0][i];
				ad[0][1]+=H0[0][i]*cd_0[0][1][i][j]*Hd1[m][j]; bd[0][1]+=Hu1[m][j]*cd_u1[0][1][j][i]*H0[0][i];
				ad[1][1]+=H0[0][i]*cd_0[1][1][i][j]*Hd1[m][j]; bd[1][1]+=Hu1[m][j]*cd_u1[1][1][j][i]*H0[0][i];
			};
		};
		Au[0][0][m]=au[0][0]*au[0][0]; Bu[0][0][m]=bu[0][0]*bu[0][0]; Ad[0][0][m]=ad[0][0]*ad[0][0]; Bd[0][0][m]=bd[0][0]*bd[0][0];
		Au[1][1][m]=au[1][0]*au[1][0]; Bu[1][1][m]=bu[1][0]*bu[1][0]; Ad[1][1][m]=ad[1][0]*ad[1][0]; Bd[1][1][m]=bd[1][0]*bd[1][0];
		Au[2][2][m]=au[0][1]*au[0][1]; Bu[2][2][m]=bu[0][1]*bu[0][1]; Ad[2][2][m]=ad[0][1]*ad[0][1]; Bd[2][2][m]=bd[0][1]*bd[0][1];
		Au[3][3][m]=au[1][1]*au[1][1]; Bu[3][3][m]=bu[1][1]*bu[1][1]; Ad[3][3][m]=ad[1][1]*ad[1][1]; Bd[3][3][m]=bd[1][1]*bd[1][1];
		
		Au[0][1][m]=Au[1][0][m]=au[0][0]*au[1][0]; Bu[0][1][m]=Bu[1][0][m]=bu[0][0]*bu[1][0];
		Ad[0][1][m]=Ad[1][0][m]=ad[0][0]*ad[1][0]; Bd[0][1][m]=Bd[1][0][m]=bd[0][0]*bd[1][0];
		Au[0][2][m]=Au[2][0][m]=au[0][0]*au[0][1]; Bu[0][2][m]=Bu[2][0][m]=bu[0][0]*bu[0][1];
		Ad[0][2][m]=Ad[2][0][m]=ad[0][0]*ad[0][1]; Bd[0][2][m]=Bd[2][0][m]=bd[0][0]*bd[0][1];
		Au[0][3][m]=Au[3][0][m]=au[0][0]*au[1][1]; Bu[0][3][m]=Bu[3][0][m]=bu[0][0]*bu[1][1];
		Ad[0][3][m]=Ad[3][0][m]=ad[0][0]*ad[1][1]; Bd[0][3][m]=Bd[3][0][m]=bd[0][0]*bd[1][1];
		Au[1][2][m]=Au[2][1][m]=au[1][0]*au[0][1]; Bu[1][2][m]=Bu[2][1][m]=bu[1][0]*bu[0][1];
		Ad[1][2][m]=Ad[2][1][m]=ad[1][0]*ad[0][1]; Bd[1][2][m]=Bd[2][1][m]=bd[1][0]*bd[0][1];
		Au[1][3][m]=Au[3][1][m]=au[1][0]*au[1][1]; Bu[1][3][m]=Bu[3][1][m]=bu[1][0]*bu[1][1];
		Ad[1][3][m]=Ad[3][1][m]=ad[1][0]*ad[1][1]; Bd[1][3][m]=Bd[3][1][m]=bd[1][0]*bd[1][1];
		Au[2][3][m]=Au[3][2][m]=au[0][1]*au[1][1]; Bu[2][3][m]=Bu[3][2][m]=bu[0][1]*bu[1][1];
		Ad[2][3][m]=Ad[3][2][m]=ad[0][1]*ad[1][1]; Bd[2][3][m]=Bd[3][2][m]=bd[0][1]*bd[1][1];
	};
	
	// omega のループ、始まり
	for(n_omega=0;n_omega<=1000;++n_omega){
	 omega=-20.0+n_omega/50.0;
	 //if(omega/10.0==rint(omega/10.0)) cout<<"(omega="<<omega<<" まで来ています)\n";
	 // 代理系の自由電子のグリーン関数の逆行列
	 GRI0u[0][0]=(omega+mu)-(ee-F-AF); GRI0u[1][1]=(omega+mu)-(ee-F+AF); GRI0u[2][2]=(omega+mu)-(ee-F+AF); GRI0u[3][3]=(omega+mu)-(ee-F-AF);
	 GRI0d[0][0]=(omega+mu)-(ee+F+AF); GRI0d[1][1]=(omega+mu)-(ee+F-AF); GRI0d[2][2]=(omega+mu)-(ee+F-AF); GRI0d[3][3]=(omega+mu)-(ee+F+AF);
	 GRI0u[0][1]=GRI0u[1][0]=GRI0u[0][2]=GRI0u[2][0]=GRI0u[1][3]=GRI0u[3][1]=GRI0u[2][3]=GRI0u[3][2]=tt;
	 GRI0d[0][1]=GRI0d[1][0]=GRI0d[0][2]=GRI0d[2][0]=GRI0d[1][3]=GRI0d[3][1]=GRI0d[2][3]=GRI0d[3][2]=tt;
	 GRI0u[0][3]=GRI0u[3][0]=GRI0u[1][2]=GRI0u[2][1]=ttn;
	 GRI0d[0][3]=GRI0d[3][0]=GRI0d[1][2]=GRI0d[2][1]=ttn;
	 // 代理系のグリーン関数
	 for(i=0;i<=3;++i){
	 	for(j=0;j<=3;++j){
	 		GRu[i][j]=GRd[i][j]=0.0;
	 		for(m=0;m<=55;++m){
	 			if(fabs(Au[i][j][m])>0.0000001) GRu[i][j]+=Au[i][j][m]/(omega-Eu1[m]+E0[0]);
	 			if(fabs(Bu[i][j][m])>0.0000001) GRu[i][j]+=Bu[i][j][m]/(omega-E0[0]+Ed1[m]);
	 			if(fabs(Ad[i][j][m])>0.0000001) GRd[i][j]+=Ad[i][j][m]/(omega-Ed1[m]+E0[0]);
	 			if(fabs(Bd[i][j][m])>0.0000001) GRd[i][j]+=Bd[i][j][m]/(omega-E0[0]+Eu1[m]);
	 		};
	 		if(fabs(GRu[i][j])<0.000000001) GRu[i][j]=0.0;
	 		if(fabs(GRd[i][j])<0.000000001) GRd[i][j]=0.0;
	 		/*
	 		if((F==0.0)&&(AF==0.0)&&(fabs(GRu[i][j]-GRd[i][j])>0.0000001)){
	 			cout << "(i,j)=(" << i << "," << j << ") : (GRu[i][j],GRd[i][j])=("<<GRu[i][j]<<","<<GRd[i][j]<<")\n";
	 			alpha=GRu[i][j]-GRd[i][j];
	 			GRu[i][j]-=alpha/2.0;
	 			GRd[i][j]=GRu[i][j];
	 		};
	 		*/
	 		
	 	};
	 };
	 // 代理系のグリーン関数の対角化
	 dsyev_( jobz, uplo, 4, (double**)GRu, 4, gRu, work, 11, info);
	 if(info!=0) cout << "omega=" << omega << ": info=" << info << "\n";
	 dsyev_( jobz, uplo, 4, (double**)GRd, 4, gRd, work, 11, info);
	 if(info!=0) cout << "omega=" << omega << ": info=" << info << "\n";
	 // Sur,Sdr ; Nur,Ndr
	 for(i=0;i<=3;++i){
	 	if(gRu[i]>0.0){
	 		Sur-=1.0/(4.0*50.0); Nur+=1;
	 	};
	 	if(gRd[i]>0.0){
	 		Sdr-=1.0/(4.0*50.0); Ndr+=1;
	 	};
	 };
	 // 代理系の自己エネルギー（代理系のグリーン関数を対角化する表示）
	 for(i=0;i<=3;++i){
	 	for(j=0;j<=3;++j){
	 		SEu[i][j]=SEd[i][j]=0.0;
	 		for(m=0;m<=3;++m){
	 			for(n=0;n<=3;++n){
	 				SEu[i][j]+=GRu[i][m]*GRI0u[m][n]*GRu[j][n];
	 				SEd[i][j]+=GRd[i][m]*GRI0d[m][n]*GRd[j][n];
	 			};
	 		};
	 	};
	 };
	 for(i=0;i<=3;++i){
	 	SEu[i][i]+=-1.0/gRu[i]; SEd[i][i]+=-1.0/gRd[i];
	 };
	 // U=0.0 のとき、自己エネルギーは 0 か？
	 for(i=0;i<=3;++i){
	 	for(j=0;j<=3;++j){
	 		if((U==0.0)&&(fabs(SEu[i][j])>0.0000001)){
	 			cout<<"omega="<<omega<<", (i,j)=("<<i<<","<<j<<"), SEu[i][j]="<<SEu[i][j]<<"\n";
	 		};
	 		if((U==0.0)&&(fabs(SEd[i][j])>0.0000001)){
	 			cout<<"omega="<<omega<<", (i,j)=("<<i<<","<<j<<"), SEd[i][j]="<<SEd[i][j]<<"\n";
	 		};
	 	};
	 };
	 
	 // 元の系のグリーン関数 ; Sug,Sdg ; Nug,Ndg
	 for(kx=0;kx<=255;++kx){
	 	for(ky=0;ky<=255;++ky){
			Kx=pi*(kx-127.0)/128.0;
	 		Ky=pi*(ky-127.0)/128.0;
	 		// 元の系のバンド構造(分散関係)、並進対称性を壊さない部分
	 		band=-2*t*cos(Kx)-2*t*cos(Ky)-4*tn*cos(Kx)*cos(Ky);
	 		// 元の系のグリーン関数の逆行列
	 		for(i=0;i<=3;++i){
	 			GIu[i][i]=omega+mu-e+h-SEu[i][i]-band;
	 			GId[i][i]=omega+mu-e-h-SEd[i][i]-band;
	 		};
	 		GIu[1][0]=t;  GIu[2][0]=t;
	 		GIu[3][1]=t;  GIu[3][2]=t;
	 		GIu[3][0]=tn; GIu[2][1]=tn;
	 		GId[1][0]=t;  GId[2][0]=t;
	 		GId[3][1]=t;  GId[3][2]=t;
	 		GId[3][0]=tn; GId[2][1]=tn;
	 		// 元の系のグリーン関数の逆行列の対角化
	 		 dsyev_( jobz, uplo, 4, (double**)GIu, 4, gIu, work, 11, info);
	 		 if(info!=0) cout<<"omega="<<omega<<", (Kx,Ky)=("<<Kx<<","<<Ky<<") : info="<<info<<"(GIu)\n";
	 		 dsyev_( jobz, uplo, 4, (double**)GId, 4, gId, work, 11, info);
	 		 if(info!=0) cout<<"omega="<<omega<<", (Kx,Ky)=("<<Kx<<","<<Ky<<") : info="<<info<<"(GId)\n";
	 		 // Sug,Sdg ; Nug,Ndg
	 		 for(i=0;i<=3;++i){
	 		 	if(gIu[i]>0.0){
	 		 		Sug-=1.0/(4.0*256.0*256.0*50.0); Nug+=1;
	 		 	};
	 		 	if(gId[i]>0.0){
	 		 		Sdg-=1.0/(4.0*256.0*256.0*50.0); Ndg+=1;
	 		 	};
	 		 };
	 	};
	 };
	 
	 
	};// omega のループ、終わり
	
	// 熱力学ポテンシャル
	Omega_t[n_AF]=Omega_r-Sur-Sdr+Sug+Sdg;
	Sr=Sur+Sdr; Sg=Sug+Sdg;
	cout <<"Omega_t="<<Omega_t[n_AF]<<"\n";
	cout <<"(Omega_r,Sr,Sg)=("<<Omega_r<<","<<Sr<<","<<Sg<<")\n";
	cout <<"(Sur,Sdr;Sug,Sdg)=("<<Sur<<","<<Sdr<<";"<<Sug<<","<<Sdg<<")\n";
	cout <<"(Nur,Ndr;Nug,Ndg)=("<<Nur<<","<<Ndr<<";"<<Nug<<","<<Ndg<<")\n";
	
	if(Omega>Omega_t[n_AF]){
		Omega=Omega_t[n_AF]; AFa=AF;
	};
	
	};// AF のループ、終わり
	
	cout<<"AFa="<<AFa<<"\n";
	
	// 書き出し
	ofstream fout;
	
	fout.open("Omega_t_AF_24_12_s_p_ss.dat");
	for(n_AF=0;n_AF<=12;++n_AF){
		AF=0.1*n_AF;
		fout << AF << " " << Omega_t[n_AF]-Omega_t[0] << "\n";
	};
	fout.close();
	/*
	fout.open("Omega_r_AF_8_4_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Omega_r[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sr_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sr[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sg_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sg[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sur_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sur[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sdr_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sdr[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sug_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sug[n_AF] << "\n";
	};
	fout.close();
	
	fout.open("Sdg_AF_4_2_s.dat");
	for(n_AF=0;n_AF<=10;++n_AF){
		fout << Sdg[n_AF] << "\n";
	};
	fout.close();
	*/
	
};
